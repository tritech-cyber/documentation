!function e(t,r,n){function i(s,a){if(!r[s]){if(!t[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var c=r[s]={exports:{}};t[s][0].call(c.exports,function(e){var r=t[s][1][e];return i(r?r:e)},c,c.exports,e,t,r,n)}return r[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(e,t,r){function n(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function o(e){if(f===setTimeout)return setTimeout(e,0);if((f===n||!f)&&setTimeout)return f=setTimeout,setTimeout(e,0);try{return f(e,0)}catch(t){try{return f.call(null,e,0)}catch(t){return f.call(this,e,0)}}}function s(e){if(d===clearTimeout)return clearTimeout(e);if((d===i||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(e);try{return d(e)}catch(t){try{return d.call(null,e)}catch(t){return d.call(this,e)}}}function a(){y&&p&&(y=!1,p.length?v=p.concat(v):_=-1,v.length&&u())}function u(){if(!y){var e=o(a);y=!0;for(var t=v.length;t;){for(p=v,v=[];++_<t;)p&&p[_].run();_=-1,t=v.length}p=null,y=!1,s(e)}}function l(e,t){this.fun=e,this.array=t}function c(){}var f,d,h=t.exports={};!function(){try{f="function"==typeof setTimeout?setTimeout:n}catch(e){f=n}try{d="function"==typeof clearTimeout?clearTimeout:i}catch(e){d=i}}();var p,v=[],y=!1,_=-1;h.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];v.push(new l(e,t)),1!==v.length||y||o(u)},l.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=c,h.addListener=c,h.once=c,h.off=c,h.removeListener=c,h.removeAllListeners=c,h.emit=c,h.prependListener=c,h.prependOnceListener=c,h.listeners=function(e){return[]},h.binding=function(e){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(e){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},{}],2:[function(e,t,r){(function(n,i){!function(e,n){"object"==typeof r&&"undefined"!=typeof t?t.exports=n():"function"==typeof define&&define.amd?define(n):e.ES6Promise=n()}(this,function(){"use strict";function t(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)}function r(e){return"function"==typeof e}function o(e){z=e}function s(e){Q=e}function a(){return function(){return n.nextTick(d)}}function u(){return"undefined"!=typeof K?function(){K(d)}:f()}function l(){var e=0,t=new J(d),r=document.createTextNode("");return t.observe(r,{characterData:!0}),function(){r.data=e=++e%2}}function c(){var e=new MessageChannel;return e.port1.onmessage=d,function(){return e.port2.postMessage(0)}}function f(){var e=setTimeout;return function(){return e(d,1)}}function d(){for(var e=0;e<Y;e+=2){var t=re[e],r=re[e+1];t(r),re[e]=void 0,re[e+1]=void 0}Y=0}function h(){try{var t=e,r=t("vertx");return K=r.runOnLoop||r.runOnContext,u()}catch(n){return f()}}function p(e,t){var r=arguments,n=this,i=new this.constructor(y);void 0===i[ie]&&x(i);var o=n._state;return o?!function(){var e=r[o-1];Q(function(){return C(o,i,e,n._result)})}():j(n,i,e,t),i}function v(e){var t=this;if(e&&"object"==typeof e&&e.constructor===t)return e;var r=new t(y);return T(r,e),r}function y(){}function _(){return new TypeError("You cannot resolve a promise with itself")}function g(){return new TypeError("A promises callback cannot return that same promise.")}function A(e){try{return e.then}catch(t){return ue.error=t,ue}}function m(e,t,r,n){try{e.call(t,r,n)}catch(i){return i}}function k(e,t,r){Q(function(e){var n=!1,i=m(r,t,function(r){n||(n=!0,t!==r?T(e,r):R(e,r))},function(t){n||(n=!0,O(e,t))},"Settle: "+(e._label||" unknown promise"));!n&&i&&(n=!0,O(e,i))},e)}function w(e,t){t._state===se?R(e,t._result):t._state===ae?O(e,t._result):j(t,void 0,function(t){return T(e,t)},function(t){return O(e,t)})}function b(e,t,n){t.constructor===e.constructor&&n===p&&t.constructor.resolve===v?w(e,t):n===ue?(O(e,ue.error),ue.error=null):void 0===n?R(e,t):r(n)?k(e,t,n):R(e,t)}function T(e,r){e===r?O(e,_()):t(r)?b(e,r,A(r)):R(e,r)}function E(e){e._onerror&&e._onerror(e._result),P(e)}function R(e,t){e._state===oe&&(e._result=t,e._state=se,0!==e._subscribers.length&&Q(P,e))}function O(e,t){e._state===oe&&(e._state=ae,e._result=t,Q(E,e))}function j(e,t,r,n){var i=e._subscribers,o=i.length;e._onerror=null,i[o]=t,i[o+se]=r,i[o+ae]=n,0===o&&e._state&&Q(P,e)}function P(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n=void 0,i=void 0,o=e._result,s=0;s<t.length;s+=3)n=t[s],i=t[s+r],n?C(r,n,i,o):i(o);e._subscribers.length=0}}function L(){this.error=null}function S(e,t){try{return e(t)}catch(r){return le.error=r,le}}function C(e,t,n,i){var o=r(n),s=void 0,a=void 0,u=void 0,l=void 0;if(o){if(s=S(n,i),s===le?(l=!0,a=s.error,s.error=null):u=!0,t===s)return void O(t,g())}else s=i,u=!0;t._state!==oe||(o&&u?T(t,s):l?O(t,a):e===se?R(t,s):e===ae&&O(t,s))}function M(e,t){try{t(function(t){T(e,t)},function(t){O(e,t)})}catch(r){O(e,r)}}function I(){return ce++}function x(e){e[ie]=ce++,e._state=void 0,e._result=void 0,e._subscribers=[]}function N(e,t){this._instanceConstructor=e,this.promise=new e(y),this.promise[ie]||x(this.promise),H(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?R(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&R(this.promise,this._result))):O(this.promise,V())}function V(){return new Error("Array Methods must be provided an Array")}function D(e){return new N(this,e).promise}function U(e){var t=this;return new t(H(e)?function(r,n){for(var i=e.length,o=0;o<i;o++)t.resolve(e[o]).then(r,n)}:function(e,t){return t(new TypeError("You must pass an array to race."))})}function q(e){var t=this,r=new t(y);return O(r,e),r}function W(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function F(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function X(e){this[ie]=I(),this._result=this._state=void 0,this._subscribers=[],y!==e&&("function"!=typeof e&&W(),this instanceof X?M(this,e):F())}function B(){var e=void 0;if("undefined"!=typeof i)e=i;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var r=e.Promise;if(r){var n=null;try{n=Object.prototype.toString.call(r.resolve())}catch(t){}if("[object Promise]"===n&&!r.cast)return}e.Promise=X}var G=void 0;G=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var H=G,Y=0,K=void 0,z=void 0,Q=function(e,t){re[Y]=e,re[Y+1]=t,Y+=2,2===Y&&(z?z(d):ne())},$="undefined"!=typeof window?window:void 0,Z=$||{},J=Z.MutationObserver||Z.WebKitMutationObserver,ee="undefined"==typeof self&&"undefined"!=typeof n&&"[object process]"==={}.toString.call(n),te="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,re=new Array(1e3),ne=void 0;ne=ee?a():J?l():te?c():void 0===$&&"function"==typeof e?h():f();var ie=Math.random().toString(36).substring(16),oe=void 0,se=1,ae=2,ue=new L,le=new L,ce=0;return N.prototype._enumerate=function(e){for(var t=0;this._state===oe&&t<e.length;t++)this._eachEntry(e[t],t)},N.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===v){var i=A(e);if(i===p&&e._state!==oe)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(r===X){var o=new r(y);b(o,e,i),this._willSettleAt(o,t)}else this._willSettleAt(new r(function(t){return t(e)}),t)}else this._willSettleAt(n(e),t)},N.prototype._settledAt=function(e,t,r){var n=this.promise;n._state===oe&&(this._remaining--,e===ae?O(n,r):this._result[t]=r),0===this._remaining&&R(n,this._result)},N.prototype._willSettleAt=function(e,t){var r=this;j(e,void 0,function(e){return r._settledAt(se,t,e)},function(e){return r._settledAt(ae,t,e)})},X.all=D,X.race=U,X.resolve=v,X.reject=q,X._setScheduler=o,X._setAsap=s,X._asap=Q,X.prototype={constructor:X,then:p,"catch":function(e){return this.then(null,e)}},X.polyfill=B,X.Promise=X,X})}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:1}],3:[function(e,t,r){!function(){var e={};if(!Object.setPrototypeOf&&!e.__proto__){var t=Object.getPrototypeOf;Object.getPrototypeOf=function(e){return e.__proto__?e.__proto__:t.call(Object,e)}}}()},{}],4:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function o(e,t){n(this,o),this.version=e,this.value=t};t.exports=i},{}],5:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("../utils/xhr.js"),a=n(s),u=e("../utils/jxon.js"),l=n(u),c=e("../utils/logger.js"),f=n(c),d=e("../error/vast-error-type.js"),h=n(d),p=e("../error/vast-error.js"),v=n(p),y="undefined"==typeof Promise?e("es6-promise").Promise:Promise,_=function(){function e(){i(this,e),this.xhr=null}return o(e,[{key:"requestAd",value:function(e,t){var r=this;return new y(function(n,i){r.xhr=new a["default"],r.xhr.getRequest(e,t).then(function(e){try{var t=(new l["default"]).build(e);n(t)}catch(r){i(new v["default"](h["default"].XML_PARSE_ERROR))}},function(e){f["default"].log("LOADING FAILED"),i(e)})})}},{key:"abort",value:function(){this.xhr&&this.xhr.abort()}}]),e}();t.exports=_},{"../error/vast-error-type.js":16,"../error/vast-error.js":17,"../utils/jxon.js":20,"../utils/logger.js":22,"../utils/xhr.js":24,"es6-promise":2}],6:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("../utils/config.js"),a=(n(s),e("../utils/logger.js")),u=(n(a),e("../error/vast-error-type.js")),l=n(u),c=e("../error/vast-error.js"),f=n(c),d=e("../utils/tracker.js"),h=(n(d),e("../utils/lib.js")),p=e("../utils/jxon.js"),v=(n(p),function(){function e(t){i(this,e),this.data_=t,this.adSystem=null,this.impressionURLs=[],this.errorURLs=[],this.extensions=[],this.pricing=null,this.clickTrackings=[],this.customClicks=[],this.trackingEvents=[],this.icons=[],this.setAdSystem_(),this.setImpressions_(),this.setError_(),this.setPricing_(),this.setExtensions_()}return o(e,[{key:"hasLinear",value:function(){return!!this.getLinear()}},{key:"getLinear",value:function(){return this.getCreative("Linear")}},{key:"getCompanionAds",value:function(){return this.getCreative("CompanionAds")}},{key:"getNonLinearAds",value:function(){return this.getCreative("NonLinearAds")}},{key:"getCreative",value:function(e){var t=this.data_.Creatives&&this.data_.Creatives.Creative,r=[];if(t)if(Array.isArray(t)){var n=0,i=t.length;for(n;n<i;n++)t[n][e]&&r.push(t[n])}else t[e]&&r.push(t);return r}},{key:"setExtensions_",value:function(){if(this.data_.Extensions){var e=this.data_.Extensions.Extension;if(!e)return;if(this.extensions=this.extensions||[],Array.isArray(e)){var t=0,r=e.length;for(t;t<r;t++)this.extensions.push(e[t])}else this.extensions.push(e)}}},{key:"setAdSystem_",value:function(){this.validateRequiredProperty_("AdSystem")&&(this.data_.AdSystem["@version"]?this.adSystem={version:this.data_.AdSystem["@version"],val:this.data_.AdSystem.keyValue}:this.adSystem=this.data_.AdSystem)}},{key:"setError_",value:function(){var e=this;this.data_.Error&&((0,h.isArray)(this.data_.Error)?this.data_.Error.forEach(function(t){t&&e.errorURLs.push(t)}):this.errorURLs.push(this.data_.Error))}},{key:"setImpressions_",value:function(){var e=this,t=this.data_.Impression;t&&(Array.isArray(t)?t.forEach(function(t){t&&e.impressionURLs.push(t["@id"]?t.keyValue:t)}):this.impressionURLs.push(t.keyValue?t.keyValue:t))}},{key:"setPricing_",value:function(){if(this.data_.Pricing&&!this.pricing){if(!this.data_.Pricing.keyValue||!this.data_.Pricing["@model"]||!this.data_.Pricing["@currency"])return;this.pricing={model:this.data_.Pricing["@model"],currency:this.data_.Pricing["@currency"],value:this.data_.Pricing.keyValue}}}},{key:"buildOptionalProperty_",value:function(e,t){this.data_[t]&&(this[e]=this.data_[t])}},{key:"validateRequiredProperty_",value:function(e){var t=this.data_[e];if(t&&t.keyValue&&(t=t.keyValue),!t)throw new f["default"](l["default"].VAST_VALIDATION_ERROR);return!0}}]),e}());t.exports=v},{"../error/vast-error-type.js":16,"../error/vast-error.js":17,"../utils/config.js":18,"../utils/jxon.js":20,"../utils/lib.js":21,"../utils/logger.js":22,"../utils/tracker.js":23}],7:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function o(e){n(this,o),this.id=e["@id"],this.url=e.keyValue};t.exports=i},{}],8:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("./base-ad.js"),l=n(u),c=e("../creative/linear-creative.js"),f=n(c),d=e("../error/vast-error.js"),h=n(d),p=e("../error/vast-error-type.js"),v=n(p),y=e("../utils/logger.js"),_=(n(y),function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));r.adTitle="",r.media=[],r.duration=0,r.clickThrough="",r.description="",r.advertiser="",r.adParameters=null,r.skipoffset=0,r.buildOptionalProperty_("adTitle","AdTitle"),r.buildOptionalProperty_("description","Description"),r.buildOptionalProperty_("advertiser","Advertiser"),r.setSurveys_();var n=r.getLinear(),s=n.length,a=null,u=0;for(u;u<s;u++)a=new f["default"](n[u]),r.trackingEvents=r.trackingEvents.concat(a.trackingEvents),r.clickTrackings=r.clickTrackings.concat(a.clickTrackings),r.customClicks=r.customClicks.concat(a.customClicks),r.media=r.media.concat(a.media),r.clickThrough=a.clickThrough?a.clickThrough:r.clickThrough,r.duration=a.duration?a.duration:r.duration,r.adParameters=a.adParameters?a.adParameters:r.adParameters,r.skipoffset=a.skipoffset?a.skipoffset:r.skipoffset;if(r.media.length<1)throw new h["default"](v["default"].VAST_VALIDATION_ERROR,"No Media File!");return r}return s(t,e),a(t,[{key:"setSurveys_",value:function(){if(this.data_.Survey){var e=function(e){var t=e["@type"]?e["@type"]:"",r=e.keyValue?e.keyValue:e;return{type:t,value:r}},t=this.data_.Survey;if(this.surveys=[],Array.isArray(t)){var r=0,n=t.length;for(r;r<n;r++)(t[r].keyValue||""!==t)&&this.surveys.push(e(t[r]))}else(t.keyValue||""!==t)&&this.surveys.push(e(t))}}}]),t}(l["default"]));t.exports=_},{"../creative/linear-creative.js":13,"../error/vast-error-type.js":16,"../error/vast-error.js":17,"../utils/logger.js":22,"./base-ad.js":6}],9:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("./impression.js"),a=(n(s),e("./ad-system.js")),u=(n(a),e("./inline-ad.js")),l=n(u),c=e("./wrapper-ad.js"),f=n(c),d=e("../utils/logger.js"),h=(n(d),e("../utils/tracker.js")),p=n(h),v=function(){function e(t,r){i(this,e),this.version=t.VAST["@version"],this.id=t.VAST.Ad["@id"],this.sequence=t.VAST.Ad["@sequence"],this.vastErrors=this.getVASTErrors_(t,r),this.adSystem=null,this.adTitle="",this.description="",this.advertiser="",this.media=[],this.duration=0,this.skipoffset=0,this.adParameters=null,this.clickThrough="",this.clickTrackings=[],this.customClicks=[],this.trackingEvents=[],this.impressionURLs=[],this.errorURLs=[],this.icons=[],this.surveys=[],this.pricing=[],this.extensions=[],this.data_={inline_:t,wrappers_:r},this.wrapperAds_=this.getWrapperAds_(r),this.inlineAd_=new l["default"](t.VAST.Ad.InLine),this.addProperty_("adSystem",this.inlineAd_,null),this.addProperty_("adTitle",this.inlineAd_,null),this.addProperty_("description",this.inlineAd_,null),this.addProperty_("advertiser",this.inlineAd_,null),this.addProperty_("media",this.inlineAd_,null),this.addProperty_("duration",this.inlineAd_,null),this.addProperty_("skipoffset",this.inlineAd_,null),this.addProperty_("adParameters",this.inlineAd_,null),this.addProperty_("clickThrough",this.inlineAd_,null),this.addProperty_("surveys",this.inlineAd_,null),this.addProperty_("clickTrackings",this.inlineAd_,this.wrapperAds_),this.addProperty_("customClicks",this.inlineAd_,this.wrapperAds_),this.addProperty_("trackingEvents",this.inlineAd_,this.wrapperAds_),this.addProperty_("errorURLs",this.inlineAd_,this.wrapperAds_),this.addProperty_("impressionURLs",this.inlineAd_,this.wrapperAds_),this.addProperty_("pricing",this.inlineAd_,this.wrapperAds_),this.addProperty_("extensions",this.inlineAd_,this.wrapperAds_),this.pricing&&this.pricing.length&&(this.pricing=this.pricing[0]),this.isPod()||(delete this.sequence,delete this.adPodInfo),this.tracker=new p["default"](this)}return o(e,[{key:"setPodInfo",value:function(e,t){this.adPodInfo={adPosition:e+1,isBumper:!1,maxDuration:this.duration,podIndex:e,timeOffset:0,totalAds:t}}},{key:"isPod",value:function(){return!!this.sequence}},{key:"getVASTErrors_",value:function(e,t){var r=0,n=t.length,i=[];for(r;r<n;r++)t[r].VAST.Error&&i.push(t[r].VAST.Error);return e.VAST.Error&&i.push(e.VAST.Error),i}},{key:"getWrapperAds_",value:function(e){var t=0,r=e.length,n=[];for(t;t<r;t++)n.push(new f["default"](e[t].VAST.Ad.Wrapper));return n}},{key:"addProperty_",value:function(e,t,r){function n(t){Array.isArray(t)?i[e]&&Array.isArray(i[e])?i[e]=i[e].concat(t):i[e]=t.slice(0):i[e]=t}var i=this;if(r){var o=0,s=r.length;for(o;o<s;o++)r[o][e]&&n(r[o][e])}t&&t[e]&&n(t[e])}}]),e}();t.exports=v},{"../utils/logger.js":22,"../utils/tracker.js":23,"./ad-system.js":4,"./impression.js":7,"./inline-ad.js":8,"./wrapper-ad.js":11}],10:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("../utils/logger.js"),a=(n(s),e("./vast-ad.js")),u=n(a),l=e("../utils/tracker.js"),c=(n(l),e("../error/vast-error.js")),f=(n(c),e("../error/vast-error-type.js")),d=(n(f),function(){function e(){i(this,e),this.ads=[],this.pod=[]}return o(e,[{key:"hasPod",value:function(){return!!this.pod.length}},{key:"build",value:function(e,t,r){var n=new u["default"](e,t);r?this.ads.splice(r,0,n):this.ads.push(n)}},{key:"sort",value:function(){for(var e=[],t=0,r=this.ads.length;t<r;t++)this.ads[t].isPod()?this.pod.push(this.ads[t]):e.push(this.ads[t]);if(this.pod.length)for(var n=0,i=this.pod.length;n<i;n++)this.pod[n].setPodInfo(n,i);this.ads=e}}]),e}());t.exports=d},{"../error/vast-error-type.js":16,"../error/vast-error.js":17,"../utils/logger.js":22,"../utils/tracker.js":23,"./vast-ad.js":9}],11:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=e("./base-ad.js"),u=n(a),l=e("../creative/linear-creative.js"),c=n(l),f=e("../utils/logger.js"),d=(n(f),function(e){function t(e){i(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));r.followAdditionalWrappers_=e["@followAdditionalWrappers"],r.allowMultipleAds_=e["@allowMultipleAds"],r.fallbackOnNoAd_=e["@fallbackOnNoAd"],r.tag=r.validateRequiredProperty_("VASTAdTagURI")?e.VASTAdTagURI:"";var n=r.getLinear(),s=n.length,a=null,u=0;for(u;u<s;u++)a=new c["default"](n[u]),r.trackingEvents=r.trackingEvents.concat(a.trackingEvents),r.clickTrackings=r.clickTrackings.concat(a.clickTrackings),r.customClicks=r.customClicks.concat(a.customClicks),r.icons=r.icons.concat(a.icons);return r}return s(t,e),t}(u["default"]));t.exports=d},{"../creative/linear-creative.js":13,"../utils/logger.js":22,"./base-ad.js":6}],12:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("../error/vast-error-type.js"),a=n(s),u=e("../error/vast-error.js"),l=n(u),c=e("../utils/tracker.js"),f=(n(c),e("../utils/lib.js")),d=e("../utils/logger.js"),h=(n(d),function(){function e(t,r){i(this,e),this.data_=t,this.type=r,this.adParameters=null,this.trackingEvents=[],(0,f.mergeProps)({context:this,data:this.data_,req:[],opt:["@id","@sequence","@adID","@apiFramework"]}),this.adParameters=this.data_[r].AdParameters?this.data_[r].AdParameters:"",this.setTrackingEvents_()}return o(e,[{key:"validateRequiredProperty_",value:function(e,t){var r=t?t[e]:this.data_[e];if(r&&r.keyValue&&(r=r.keyValue),!r)throw new l["default"](a["default"].VAST_VALIDATION_ERROR);return!0}},{key:"setTrackingEvents_",value:function(){function e(e){var t={};for(var n in e)""!==n&&e.hasOwnProperty(n)&&("keyValue"===n?t.url=e[n]:t[n.substr(1)]=e[n]);r.trackingEvents.push(t)}var t=this.data_[this.type].TrackingEvents&&this.data_[this.type].TrackingEvents.Tracking,r=this;if(t)if(Array.isArray(t)){var n=0,i=t.length;for(n;n<i;n++)e(t[n])}else e(t)}}]),e}());t.exports=h},{"../error/vast-error-type.js":16,"../error/vast-error.js":17,"../utils/lib.js":21,"../utils/logger.js":22,"../utils/tracker.js":23}],13:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=e("./base-creative.js"),l=n(u),c=e("../utils/lib.js"),f=e("../error/vast-error-type.js"),d=(n(f),e("./media-file.js")),h=n(d),p=e("../utils/logger.js"),v=n(p),y=function(e){function t(e,r){i(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,"Linear"));return n.media=[],n.clickThrough="",n.clickTrackings=[],n.customClicks=[],n.skipoffset=0,n.duration=0,n.setVideoClicks_(),n.setDuration_(),n.setSkipOffset_(),n.setMedia_(),n}return s(t,e),a(t,[{key:"setSkipOffset_",value:function(){var e=this.data_.Linear["@skipoffset"];e&&(e.indexOf("%")===-1?this.skipoffset=(0,c.parseDuration)(e):this.duration&&(this.skipoffset=e.split("%")[0]/100*this.duration))}},{key:"setDuration_",value:function(){var e=this.data_.Linear.Duration;e&&(this.duration=(0,c.parseDuration)(this.data_.Linear.Duration))}},{key:"setMedia_",value:function(){function e(e){r=new h["default"];var t=(0,c.mergeProps)({context:r,data:e,req:["@type","keyValue"],opt:["@delivery","@id","@scalable","@codec","@maintainAspectRatio","@width","@height","@bitrate","@maxBitrate","@minBitrate","@apiFramework"],valuePropName:"url"});return t?((0,c.convertStringToInt)(r,"bitrate","maxBitrate","minBitrate","height","width"),n.media.push(r)):v["default"].warn("Mediafile merge failed!"),r}var t=this.data_.Linear.MediaFiles&&this.data_.Linear.MediaFiles.MediaFile,r=null,n=this;if(t)if(Array.isArray(t)){var i=0,o=t.length;for(i;i<o&&e(t[i]);i++);}else e(t)}},{key:"setVideoClicks_",value:function(){function e(e,t){if(Array.isArray(t)){var r=0,n=t.length;for(r;r<n;r++)e.push(t[r].keyValue?t[r].keyValue:t[r])}else e.push(t.keyValue?t.keyValue:t)}var t=this.data_.Linear.VideoClicks,r=t&&t.ClickThrough,n=t&&t.ClickTracking,i=t&&t.CustomClick;r=Array.isArray(r)?r[0]:r,r&&(this.clickThrough=r.keyValue?r.keyValue:r),n&&e(this.clickTrackings,n),i&&e(this.customClicks,i)}}]),t}(l["default"]);t.exports=y},{"../error/vast-error-type.js":16,"../utils/lib.js":21,"../utils/logger.js":22,"./base-creative.js":12,"./media-file.js":14}],14:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=e("../error/vast-error-type.js"),s=(n(o),e("../utils/lib.js"),function a(){i(this,a),this.width=0,this.height=0,this.type="",this.delivery="",this.url="",this.id="",this.scalable=!1,this.maintainAspectRatio=!1,this.codec="",this.apiFramework="",this.bitrate=-1,this.maxBitrate=-1,this.minBitrate=-1});t.exports=s},{"../error/vast-error-type.js":16,"../utils/lib.js":21}],15:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(e){function t(e){n(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return r.message=e,r.stack=(new Error).stack,r.name=r.constructor.name,r}return o(t,e),t}(Error);t.exports=s},{}],16:[function(e,t,r){"use strict";var n={XML_PARSE_ERROR:{value:100,description:"XML parsing error"},VAST_VALIDATION_ERROR:{value:101,description:"VAST schema validation error"},VAST_VERSION_ERROR:{value:102,description:"VAST version of response not supported"},TRAFFICKING_ERROR:{value:200,description:"Trafficking Error. Video player received an Ad type that it was not expecting and/or cannot display"},LINEARITY_ERROR:{value:201,description:"Video player was expecting different linearity"},DURATION_ERROR:{value:202,description:"Video player was expecting different duration"},SIZE_ERROR:{value:203,description:"Video player was expecting different size"},WRAPPER_ERROR:{value:300,description:"General Wrapper error"},WRAPPER_TIMEOUT_ERROR:{value:301,description:"VAST URI in Wrapper timed out"},WRAPPER_LIMIT_ERROR:{value:302,description:"Wrapper limit reached"},WRAPPER_NO_ADS:{value:303,description:"No ads VAST response after one or more Wrappers"},LINEAR_ERROR:{value:400,description:"Video Player unable to display the linear ad"},MEDIA_MISSING_ERROR:{value:401,description:"Unable to find Linear/MediaFile from URI"},MEDIA_TIMEOUT_ERROR:{value:402,description:"Timeout of MediaFile URI"},MEDIA_SUPPORT_ERROR:{value:403,description:"Could not find supported MediaFile"},MEDIA_DISPLAY_ERROR:{value:405,description:"Problem displaying MediaFile"},NON_LINEAR_AD_ERROR:{value:500,description:"General NonLinearAds error"},NONLINEAR_DIMENSION_ERROR:{value:501,description:"Creative dimensions do not align with creative display area"},NONLINEAR_RESORUCE_ERROR:{value:502,description:"Unable to fetch NonLinearAds/NonLinear resource"},NONLINEAR_SUPPORT_ERROR:{value:503,description:"Could not find NonLinear resource with supported type"},COMPANION_AD_ERROR:{value:600,description:"Genearl CompanionAds error"},COMPANION_DIMENSION_ERROR:{value:601,description:"Unable to display CompanonAds because creative dimensions do not align with creative display area"},COMPANION_DISPLAY_ERROR:{value:602,description:"Unable to display required Companion"},COMPANION_RESOURCE_ERROR:{value:603,description:"Unable to fetch CompanionAds/Companion resource"},COMPANION_SUPPORT_ERROR:{value:604,description:"Could not find Companion resource with supported type"},UNDEFINED_ERROR:{value:900,description:"Undefined error"},VPAID_ERROR:{value:901,description:"General VPAID Error"},VAST_LOAD_ERROR:{value:1e3,description:"The VAST response failed to load"},BLANK_VAST:{value:1001,description:"The VAST response document is empty"},VAST_LOAD_TIMEOUT:{value:1002,description:"The VAST load is timed out"},PROTOCOL_MISMATCH:{value:1003,description:"The VAST request's protocol is not https"}};t.exports=n},{}],17:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=e("./extendable-error.js"),u=n(a),l=function(e){function t(e,r,n){i(this,t),r=r?e.description+" :: "+r:e.description;var s=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,"VAST ERROR ["+e.value+"] :: "+r));return s.errorCode=e.value,s.data=n,s}return s(t,e),t}(u["default"]);t.exports=l},{"./extendable-error.js":15}],18:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{
value:!0}),r["default"]={VERSION:"1.2.3",DEBUG:!1}},{}],19:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function(){function e(){n(this,e),this.topics={},this.hOP=this.topics.hasOwnProperty}return i(e,[{key:"subscribe",value:function(e,t){this.hOP.call(this.topics,e)||(this.topics[e]=[]);var r=this.topics[e].push(t)-1;return{remove:function(){delete this.topics[e][r]}}}},{key:"publish",value:function(e,t){this.hOP.call(this.topics,e)&&this.topics[e].forEach(function(e){e(t||{})})}}]),e}();t.exports=o},{}],20:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function(){function e(){n(this,e)}return i(e,[{key:"toString",value:function(){return"null"}},{key:"valueOf",value:function(){return null}}]),e}(),s=function(){function e(){n(this,e),this.sValProp="keyValue",this.sAttrProp="keyAttributes",this.sAttrsPref="@",this.aCache=[],this.rIsNull=/^\s*$/,this.rIsBool=/^(?:true|false)$/i}return i(e,[{key:"parseText",value:function(e){return this.rIsNull.test(e)?null:this.rIsBool.test(e)?"true"===e.toLowerCase():(e=e.replace(/[\t\v\n\r]/g,"").trim(),"null"===e?null:e)}},{key:"objectify",value:function(e){return null===e?new o:e instanceof Object?e:new e.constructor(e)}},{key:"createObjTree",value:function(e,t,r,n){var i,o,s=this.aCache.length,a=e.hasChildNodes(),u=e.hasAttributes&&e.hasAttributes(),l=Boolean(2&t),c=0,f="",d=l?{}:null;if(a)for(var h,p=0;p<e.childNodes.length;p++)h=e.childNodes.item(p),4===h.nodeType?f+=h.nodeValue:3===h.nodeType?f+=h.nodeValue.trim():1!==h.nodeType||h.prefix||this.aCache.push(h);var v=this.aCache.length,y=this.parseText(f);l||!a&&!u||(d=0===t?this.objectify(y):{});for(var _=s;_<v;_++){i=this.aCache[_].nodeName,o=this.createObjTree(this.aCache[_],t,r,n);var g=!1,A=!1;if(null!==o){for(var m in o)if(o.hasOwnProperty(m)){A=!0;break}if(A)if(d.hasOwnProperty(i)&&null!==d[i]){for(var k in o)o.hasOwnProperty(k)&&k.indexOf("@")!==-1&&(o[k]||(g=!0));if(g)continue;d[i].constructor!==Array&&(d[i]=[d[i]]),d[i].push(o)}else d[i]=o,c++;else c++}else c++}if(u){for(var w,b=e.attributes.length,T=n?"":this.sAttrsPref,E=n?{}:d,R=0;R<b;c++,R++)w=e.attributes.item(R),E[T+w.name]=this.parseText(w.value.trim());n&&(r&&Object.freeze(E),d[this.sAttrProp]=E,c-=b-1)}return 3===t||(2===t||1===t&&c>0)&&f?d[this.sValProp]=y:!l&&0===c&&f&&(d=y),r&&(l||c>0)&&Object.freeze(d),this.aCache.length=s,d}},{key:"loadObjTree",value:function(e,t,r){var n,i;if(r.constructor===String||r.constructor===Number||r.constructor===Boolean){if(t.appendChild(e.createTextNode(r.toString())),r===r.valueOf())return}else r.constructor===Date&&t.appendChild(e.createTextNode(r.toUTCString()));for(var o in r)if(r.hasOwnProperty(o)){if(n=r[o],isFinite(o)||n instanceof Function)continue;if(o===this.sValProp)null!==n&&n!==!0&&t.appendChild(e.createTextNode(n.constructor===Date?n.toUTCString():String(n)));else if(o===this.sAttrProp)for(var s in n)n.hasOwnProperty(s)&&t.setAttribute(s,n[s]);else if(o.charAt(0)===this.sAttrsPref)t.setAttribute(o.slice(1),n);else if(n.constructor===Array)for(var a=0;a<n.length;a++)i=e.createElement(o),this.loadObjTree(e,i,n[a]),t.appendChild(i);else i=e.createElement(o),n instanceof Object?this.loadObjTree(e,i,n):null!==n&&n!==!0&&i.appendChild(e.createTextNode(n.toString())),t.appendChild(i)}}},{key:"build",value:function(e,t,r,n){var i=arguments.length>1&&"number"==typeof t?3&t:1;return this.createObjTree(e,i,r||!1,arguments.length>3?n:3===i)}},{key:"unbuild",value:function(e,t,r,n){var i=document.implementation.createDocument(t||null,r||"",n||null);return this.loadObjTree(i,i.documentElement,e),i}}]),e}();t.exports=s},{}],21:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){if(window.DOMParser)return(new window.DOMParser).parseFromString(e,"text/xml");if("undefined"!=typeof window.ActiveXObject&&new window.ActiveXObject("Microsoft.XMLDOM")){var t=new window.ActiveXObject("Microsoft.XMLDOM");return t.async="false",t.loadXML(e),t}}function o(e){var t,r,n,i,o;return null==e?null:(t=e.split(":"),3!==t.length?null:(o=t[2].split("."),i=parseInt(o[0]),2===o.length&&(i+=parseFloat("0."+o[1])),n=parseInt(60*t[1]),r=parseInt(60*t[0]*60),isNaN(r||isNaN(n||isNaN(i||n>3600||i>60)))?null:r+n+i))}function s(e){var t=(e?e.ownerDocument||e:0).documentElement;return!!t&&"HTML"!==t.nodeName}function a(){var e=Array.from(arguments),t=e.shift(),r=e.length,n=0,i=null;for(n;n<r;n++)i=t[e[n]],i&&"string"==typeof i&&(t[e[n]]=parseInt(i))}function u(e){function t(t,r,i){var o=0,s=t.length,a=null,u=null;for(o;o<s;o++)if(a=t[o],u=a.indexOf("@")!==-1?a.substr(1):a,n[a]&&""!==n[a])"keyValue"===a&&e.valuePropName?r[e.valuePropName]=n[a]:r[u]=n[a];else if(i)return!1;return!0}var r=e.context,n=e.data;return!!t(e.req,r,!0)&&(t(e.opt,r,!1),!0)}function l(){var e=Array.from(arguments),t=e.shift(),r=e.length,n=0,i=null;for(n;n<r;n++)if(i=t[e[n]],!i||""===i)return!1;return!0}function c(e,t){for(var r=[],n=0,i=e.length;n<i;n++){var o=e[n],s="",a=o;for(s in t)t.hasOwnProperty(s)&&("CACHEBUSTING"===s&&(t.CACHEBUSTING=t.random=Math.round((new Date).getTime()/1e3)),""!==t[s]&&(a=a.replace("["+s+"]",t[s]),a=a.replace("%%"+s+"%%",t[s])));r.push(a)}return r}function f(e){var t=parseInt(e),r=Math.floor(t/3600),n=Math.floor(t/60%60),i=Math.floor(t%60),o=Math.floor(100*(e-t));return r=r<10?"0"+r:r,n=n<10?"0"+n:n,i=i<10?"0"+i:i,r+":"+n+":"+i+"."+o}function d(){var e=navigator.userAgent;return/iPhone/i.test(e)||/iPad/i.test(e)||/iPod/i.test(e)||/Android/i.test(e)}function h(){Array.from||(Array.from=function(){var e=Object.prototype.toString,t=function(t){return"function"==typeof t||"[object Function]"===e.call(t)},r=function(e){var t=Number(e);return isNaN(t)?0:0!==t&&isFinite(t)?(t>0?1:-1)*Math.floor(Math.abs(t)):t},n=Math.pow(2,53)-1,i=function(e){var t=r(e);return Math.min(Math.max(t,0),n)};return function(e){var r=this,n=Object(e);if(null==e)throw new TypeError("Array.from requires an array-like object - not null or undefined");var o,s=arguments.length>1?arguments[1]:void 0;if("undefined"!=typeof s){if(!t(s))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(o=arguments[2])}for(var a,u=i(n.length),l=t(r)?Object(new r(u)):new Array(u),c=0;c<u;)a=n[c],s?l[c]="undefined"==typeof o?s(a,c):s.call(o,a,c):l[c]=a,c+=1;return l.length=u,l}}())}Object.defineProperty(r,"__esModule",{value:!0}),r.arrayFrom=r.protocol=r.isArray=void 0,r.parseXML=i,r.parseDuration=o,r.isXML=s,r.convertStringToInt=a,r.mergeProps=u,r.validateRequired=l,r.resolveURLs=c,r.formatTime=f,r.isMobile=d;var p=e("./logger.js");n(p),r.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},r.protocol=function(){var e="http:",t=window.document.referrer;if(self!==top)if(""!==t)0===t.indexOf("https:")&&(e="https:");else try{e=top.location.protocol}catch(r){}else e=window.location.protocol;return"http:"!==e&&"https:"!==e&&(e="http:"),e}(),r.arrayFrom=h()},{"./logger.js":22}],22:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e("./config.js"),u=n(a),l=function(){function e(){i(this,e)}return s(e,null,[{key:"log",value:function(t){e.log_(t,"log")}},{key:"error",value:function(t){e.log_(t,"error")}},{key:"warn",value:function(t){e.log_(t,"warn")}},{key:"log_",value:function(e,t){u["default"].DEBUG&&(e=e&&"object"===("undefined"==typeof e?"undefined":o(e))?e:"[OVC] :: "+e,console[t]?console[t](e):console.log&&console.log(e))}}]),e}();t.exports=l},{"./config.js":18}],23:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("./logger.js"),a=n(s),u=e("../error/vast-error.js"),l=n(u),c=e("../error/vast-error-type.js"),f=n(c),d=e("./lib.js"),h=e("./events.js"),p=n(h),v=e("./config.js"),y=(n(v),function(){function e(t){i(this,e),a["default"].log("Ad Tracker Created"),this.ad=t,this.linear=!1,this.clickTrackingURLs=[],this.clickThroughURL="",this.trackingEvents=this.ad.trackingEvents.slice(0),this.impressionURLs=this.ad.impressionURLs.slice(0),this.errorURLs=this.ad.errorURLs.slice(0),this.progressEvents=[],this.skipDelay=-1,this.quartiles=[],this.progress=0,this.macros={ERRORCODE:"",CONTENTPLAYHEAD:"",ASSETURI:"",CACHEBUSTING:0,random:0},this.events=new p["default"],this.impressed=!1,this.duration=this.ad.duration,this.skipDelay=this.ad.skipoffset,this.linear=!0,this.clickTrackingURLs=this.ad.clickTrackings,this.clickThroughURL=this.ad.clickThrough;for(var r=this.getEvents("progress"),n=r.length,o=0;o<n;o++){var s=r[o].offset;s&&(s.indexOf("%")===-1?(r[o].offset=(0,d.parseDuration)(s),this.progressEvents.push(r[o])):this.duration&&(r[o].offset=s.split("%")[0]/100*this.duration,this.progressEvents.push(r[o])))}}return o(e,[{key:"pause",value:function(){a["default"].log("Tracker Pause >>>"),this.trackEvent("pause")}},{key:"resume",value:function(){a["default"].log("Tracker Resume >>>"),this.trackEvent("resume")}},{key:"mute",value:function(){a["default"].log("Tracker Mute >>>"),this.trackEvent("mute")}},{key:"unmute",value:function(){a["default"].log("Tracker unmute >>>"),this.trackEvent("unmute")}},{key:"fullscreen",value:function(){"2.0"===this.ad.version?(a["default"].log("Tracker expand"),this.trackEvent("expand")):"3.0"===this.ad.version&&(a["default"].log("Tracker fullscreen"),this.trackEvent("fullscreen"))}},{key:"exitFullscreen",value:function(){"2.0"===this.ad.version?(a["default"].log("Tracker collapse"),this.trackEvent("collapse")):"3.0"===this.ad.version&&(a["default"].log("Tracker exitFullscreen"),this.trackEvent("exitFullscreen"))}},{key:"expand",value:function(){a["default"].log("Tracker expand"),this.trackEvent("expand")}},{key:"collapse",value:function(){a["default"].log("Tracker collapse"),this.trackEvent("collapse")}},{key:"acceptInvitationLinear",value:function(){this.linear&&(a["default"].log("Tracker acceptInvitationLinear"),this.trackEvent("acceptInvitationLinear"))}},{key:"closeLinear",value:function(){a["default"].log("Tracker closeLinear"),this.trackEvent("closeLinear")}},{key:"skip",value:function(){a["default"].log("Tracker skip"),this.trackEvent("skip")}},{key:"complete",value:function(){a["default"].log("Tracker Complete >>>"),this.trackEvent("complete")}},{key:"setDuration",value:function(e){a["default"].log("Tracker Duration : "+e);for(var t=3,r=["firstQuartile","midpoint","thirdQuartile"];t>0;)this.quartiles.unshift({event:r[t-1],value:(e*(.25*t)).toFixed(2)}),t--}},{key:"setAssetURI",value:function(e){this.macros.ASSETURI=e}},{key:"trackImpression",value:function(t){this.impressed||(this.impressed=!0,this.macros.CONTENTPLAYHEAD=(0,d.formatTime)(t.toFixed(2)),this.trackEvent("start"),this.trackEvent("creativeView"),this.impressionURLs&&e.track("impression",(0,d.resolveURLs)(this.impressionURLs,this.macros)))}},{key:"setProgress",value:function(e){if(e>0){this.trackImpression(e);var t=0,r=this.quartiles.length;for(t;t<r;t++)if(e>=this.quartiles[t].value){var n=this.quartiles.shift();this.trackEvent(n.event),this.events.publish(n.event);break}e<this.progress&&this.trackEvent("rewind"),this.progress=e.toFixed(2),this.progressEvents.length&&this.trackProgress()}}},{key:"getResolvedClickthrough",value:function(){return this.macros.CONTENTPLAYHEAD=(0,d.formatTime)(this.progress),(0,d.resolveURLs)([this.clickThroughURL],this.macros)}},{key:"trackClicks",value:function(){a["default"].log("Track Clicks: "),a["default"].log(this.clickTrackingURLs),this.macros.CONTENTPLAYHEAD=(0,d.formatTime)(this.progress),e.track("clicktracking",(0,d.resolveURLs)(this.clickTrackingURLs,this.macros))}},{key:"trackQuartile",value:function(e){e&&(a["default"].log("Tracker "+e+" >>>"),this.trackEvent(e))}},{key:"trackError",value:function(t){t&&(this.macros.ERRORCODE=t.errorCode,e.track(t.message,(0,d.resolveURLs)(this.errorURLs,this.macros)))}},{key:"getError",value:function(e){for(var t in f["default"])if(f["default"].hasOwnProperty(t)){var r=f["default"][t];if(r.value===e)return new l["default"](r)}return null}},{key:"trackEvent",value:function(t){for(var r=this.getEvents(t),n=[],i=0,o=r.length;i<o;i++)n.push(r[i].url);this.macros.CONTENTPLAYHEAD=(0,d.formatTime)(this.progress),e.track(t,(0,d.resolveURLs)(n,this.macros))}},{key:"trackProgress",value:function(){var t=this.progressEvents.length;this.macros.CONTENTPLAYHEAD=(0,d.formatTime)(this.progress);for(var r=0;r<t;r++){var n=this.progressEvents[r];if(this.progress>=n.offset){e.track("progress",(0,d.resolveURLs)([n.url],this.macros));var i=this.progressEvents.indexOf(n);i!==-1&&this.progressEvents.splice(i,1);break}}}},{key:"getEvents",value:function(e){var t=0,r=this.trackingEvents.length,n=[];for(t;t<r;t++){var i=this.trackingEvents[t];i.event===e&&n.push(i)}return n}},{key:"subscribe",value:function(e,t){this.events.subscribe(e,t)}}]),e}());y.track=function(e,t){t=(0,d.isArray)(t)?t:[t];for(var r=((0,d.isMobile)(),""),n=0,i=t.length;n<i;n++)r=t[n],(new Image).src=t[n]},y.trackError=function(e,t,r){function n(e){e&&((0,d.isArray)(e)?o=o.concat(e):o.push(e))}a["default"].log("TRACK :: ERROR");var i=1001===e.errorCode||303===e.errorCode,o=[];if(t){var s=t.Ad,u=s&&s.Inline,l=s&&s.Wrapper,c=u?u.Error:l?l.Error:"";n(i?t.Error:c)}for(var f=0,h=r.length;f<h;f++){var p=r[f].VAST,v=p&&p.Error,_=p&&p.Ad,g=_&&_.Wrapper,A=g&&g.Error;i&&n(v),n(A)}y.track(e.message,(0,d.resolveURLs)(o,{ERRORCODE:e.errorCode}))},t.exports=y},{"../error/vast-error-type.js":16,"../error/vast-error.js":17,"./config.js":18,"./events.js":19,"./lib.js":21,"./logger.js":22}],24:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=e("../error/vast-error-type.js"),a=n(s),u=e("../error/vast-error.js"),l=n(u),c=e("../utils/logger.js"),f=n(c),d="undefined"==typeof Promise?e("es6-promise").Promise:Promise,h=function(){function e(){i(this,e),this.request_=null}return o(e,[{key:"abort",value:function(){this.request_&&this.request_.abort()}},{key:"getRequest",value:function(e,t){var r=this;return t?(f["default"].log("XHR >>> LOADING AD FROM XML"),new d(function(e,n){try{e(r.parse_(t))}catch(i){n(i)}})):(f["default"].log("XHR >>> LOADING AD FROM TAG >>> "+e),this.setRequest_("GET",e))}},{key:"putRequest",value:function(e,t){return this.setRequest_("PUT",e,"",t)}},{key:"postRequest",value:function(e,t){return this.setRequest_("POST",e,"",t)}},{key:"deleteRequest",value:function(e){return this.setRequest_("DELETE",e)}},{key:"setRequest_",value:function(e,t,r){var n=this;return new d(function(i,o){var s=window.XMLHttpRequest||window.ActiveXObject;n.request_=new s("MSXML2.XMLHTTP.3.0"),n.request_.onreadystatechange=function(){if(4===n.request_.readyState)if(200===n.request_.status)try{i(n.parse_(this.response))}catch(e){o(e)}else o(new l["default"](a["default"].VAST_LOAD_ERROR))},n.request_.onerror=function(){o(new l["default"](a["default"].VAST_LOAD_ERROR))},n.request_.open(e,t,!0),n.request_.withCredentials=!0,n.request_.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.request_.send(r)})}},{key:"parse_",value:function(e){var t;try{t=this.parseXML_(e)}catch(r){throw r}return t}},{key:"parseXML_",value:function(e){var t,r,n=!1,i=new DOMParser;try{r=i.parseFromString(e,"text/xml").getElementsByTagName("parsererror")[0].namespaceURI}catch(o){}try{t=i.parseFromString(e,"text/xml")}catch(o){n=!0}if(r&&t.getElementsByTagNameNS(r,"parsererror").length>0&&(n=!0),n)throw new l["default"](a["default"].XML_PARSE_ERROR);return t}}]),e}();t.exports=h},{"../error/vast-error-type.js":16,"../error/vast-error.js":17,"../utils/logger.js":22,"es6-promise":2}],25:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();e("ima.js-babel6-polyfill");var s=e("./utils/logger.js"),a=n(s),u=e("./utils/config"),l=n(u),c=e("./ad/ads-loader.js"),f=n(c),d=e("./error/vast-error-type.js"),h=n(d),p=e("./error/vast-error.js"),v=n(p),y=e("./utils/lib.js"),_=e("./utils/tracker.js"),g=n(_),A=e("./ad/vast-ads.js"),m=n(A),k=e("./ad/wrapper-ad.js"),w=(n(k),e("./ad/inline-ad.js")),b=(n(w),e("./ad/vast-ad.js")),T=(n(b),function(){function e(t,r){if(i(this,e),a["default"].log("VASTClient :: ["+l["default"].VERSION+"]"),t.debug&&(l["default"].DEBUG=t.debug),!t.tag&&!t.xml)throw new Error("Options Validation Error");if(!r||"function"!=typeof r)throw new Error("Missing Callback Function Error");this.isTimedout_=!1,this.allowMultipleAds_=null,this.fallbackOnNoAd_=null,this.followAdditionalWrappers_=null,this.adLoading_=0,this.adLoaded_=0,this.vast_=null,this.wrappers_=[],this.wrapperCount_=0,this.vastAds=new m["default"],this.adsLoader_=new f["default"],this.tracker=null,this.cb=r,this.errs=[],this.startLoadTimeout_(),this.build_(t.tag,t.xml)}return o(e,[{key:"build_",value:function(t,r,n,i){var o=this;n=n||[],this.wrappers_=n,this.adLoading_++,this.adsLoader_.requestAd(t,r).then(function(r){var s=r.VAST,u=s&&s["@version"],l=s&&s.Ad,c=l&&l.Wrapper,f=l&&l.InLine;if(o.vast_=s,o.adLoaded_++,!l)throw new v["default"](o.wrappers_.length?h["default"].WRAPPER_NO_ADS:h["default"].BLANK_VAST);if(a["default"].log("VASTClient ::  _build :: Ad Loaded: "+t),"2.0"!==u&&"3.0"!==u)throw new v["default"](h["default"].VAST_VERSION_ERROR);if(c&&o.followAdditionalWrappers_!==!1){if(!c.VASTAdTagURI)throw new v["default"](h["default"].VAST_VALIDATION_ERROR,"No VASTAdTagURI in Wrapper!");if(o.wrapperCount_++,o.followAdditionalWrappers_=c["@followAdditionalWrappers"]?c["@followAdditionalWrappers"]:o.followAdditionalWrappers_,o.allowMultipleAds_=c["@allowMultipleAds_"]?c["@allowMultipleAds_"]:o.allowMultipleAds_,o.wrapperCount_===e.MAX_WRAPPERS_ALLOWED)throw new v["default"](h["default"].WRAPPER_LIMIT_ERROR,"(Limit Set: "+e.MAX_WRAPPERS_ALLOWED+")");n.push(r),o.build_(c.VASTAdTagURI,null,n)}else if(f)o.vastAds.build(r,n,i);else if((0,y.isArray)(l))for(var d=0,p=l.length;d<p;d++){var _=l[d],g=_.Wrapper,A=_.InLine,m=n.slice(0),k={VAST:{"@version":s["@version"],Ad:_,Error:s.Error}};if(g&&o.followAdditionalWrappers_!==!1&&o.allowMultipleAds_!==!1){if(o.wrapperCount_++,o.wrapperCount_===e.MAX_WRAPPERS_ALLOWED){a["default"].warn("VASTClient :: Wrapper count exceeded.  Ignoring.");continue}o.followAdditionalWrappers_=g["@followAdditionalWrappers"]?g["@followAdditionalWrappers"]:o.followAdditionalWrappers_,o.allowMultipleAds_=g["@allowMultipleAds"]?g["@allowMultipleAds"]:o.allowMultipleAds_,m.push(k),o.build_(g.VASTAdTagURI,null,m,i?i:o.vastAds.ads.length)}else if(A)if(n.length){var w=n[n.length-1].VAST.Ad.Wrapper,b=w["@allowMultipleAds"];b===!1?_["@sequence"]||w.firstAdBuilt||(w.firstAdBuilt=!0,o.vastAds.build(k,n,i)):o.vastAds.build(k,n,i)}else o.vastAds.build(k,n,i);else g&&o.followAdditionalWrappers_===!1&&a["default"].warn("VASTClient :: Additional Wrapper not allowed. Ignoring")}else c&&o.followAdditionalWrappers_===!1&&a["default"].warn("VASTClient :: Additional Wrapper not allowed. Ignoring");o.adLoading_===o.adLoaded_&&o.done()})["catch"](function(e){a["default"].log("VASTClient :: ErrorCode: "+e.errorCode+" message: "+e.message),1e3!==e.errorCode&&100!==e.errorCode||o.adLoaded_++,o.errs.push(e),g["default"].trackError(e,o.vast_,o.wrappers_),o.adLoading_===o.adLoaded_&&o.done()})}},{key:"done",value:function(){a["default"].log("VASTClient :: done :: "+this.adLoading_+" || "+this.adLoaded_),this.stopLoadTimeout_(),this.adsLoader_&&(this.adsLoader_.abort(),this.adsLoader_=null);var e=this.vastAds.ads;e.length?(this.vastAds.sort(),this.cb(null,this.vastAds)):this.cb(this.errs[0])}},{key:"getAds",value:function(){return this.vastAds}},{key:"startLoadTimeout_",value:function(){var t=this;this.loadTimerID_=window.setTimeout(function(){t.isTimedout_=!0,t.done()},e.LOAD_TIMEOUT)}},{key:"stopLoadTimeout_",value:function(){window.clearInterval(this.loadTimerID_),this.loadTimerID_=null}}]),e}());T.MAX_WRAPPERS_ALLOWED=4,T.LOAD_TIMEOUT=3e3;var E=window.opti||{};window.opti=E,E.VASTClient=T,t.exports=E.VASTClient},{"./ad/ads-loader.js":5,"./ad/inline-ad.js":8,"./ad/vast-ad.js":9,"./ad/vast-ads.js":10,"./ad/wrapper-ad.js":11,"./error/vast-error-type.js":16,"./error/vast-error.js":17,"./utils/config":18,"./utils/lib.js":21,"./utils/logger.js":22,"./utils/tracker.js":23,"ima.js-babel6-polyfill":3}]},{},[25]);
!function t(e,i,s){function a(o,r){if(!i[o]){if(!e[o]){var d="function"==typeof require&&require;if(!r&&d)return d(o,!0);if(n)return n(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var h=i[o]={exports:{}};e[o][0].call(h.exports,function(t){var i=e[o][1][t];return a(i?i:t)},h,h.exports,t,e,i,s)}return i[o].exports}for(var n="function"==typeof require&&require,o=0;o<s.length;o++)a(s[o]);return a}({1:[function(t,e,i){!function(){var t={};if(!Object.setPrototypeOf&&!t.__proto__){var e=Object.getPrototypeOf;Object.getPrototypeOf=function(t){return t.__proto__?t.__proto__:e.call(Object,t)}}}()},{}],2:[function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0}),i.AdPlayer=void 0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),o=t("../utils/utility"),r=s(o),d=t("../utils/tracker"),l=t("../config"),h=s(l),u=t("./html5-ad"),c=s(u),p=t("./vpaid-ad"),v=s(p),f=t("./flash-ad"),y=s(f);i.AdPlayer=function(){function t(e,i,s,n,o,d,l){a(this,t),this.isActive=!0,this.isAdLoading=!1,this.isAdLoaded=!1,this.isAdStartInit=!1,this.isAdImpressed=!1,this.slot=e,this.videoslot=i,this.adVo=s,this.ref=n,this.idx=d,this.adSlot=document.createElement("div"),this.adSlot.id="opti-ad-slot"+d,this.slot.appendChild(this.adSlot),this.adData=o,this.adData.reqIdx=l,this.ad=null,this.moat=null,this.ids={level1:this.adVo.id,level2:this.adVo.zone,level3:"",level4:"",slicer1:r["default"].domainData.hostname,slicer2:""},this.testVid=document.createElement("video"),this.loadTime=0,this.startTime=0,this.responseTime=0,this.maxTime=25e3,this.timeoutID=0,this.vastClient=null,this.vastAd=null,this.sources=[],this.source=null,this.srcIdx=0,this.isPlayerInit=!1,this.isQuartilesDone=!1,this.isSkipped=!1,this.isStopped=!1,this.isStopAdCalled=!1,this.requestAd(this.adData)}return n(t,[{key:"setVolume",value:function(t){this.ad&&this.ad.setVolume(t)}},{key:"getRemainingTime",value:function(){return this.ad?this.ad.getRemainingTime():void 0}},{key:"getDuration",value:function(){return this.ad?this.ad.getDuration():void 0}},{key:"requestAd",value:function(t){this.isAdLoading=!0,this.adData=t,this.maxTime=2*this.adData.ac*1e3,this.ids.level3=this.adData.adID,this.startTime=r["default"].now(),this.timeoutID=setTimeout(this.checkResponseTime_.bind(this),100);var e=t.adUrl;if(this.adVo.retry)try{e=r["default"].addURLParam(t.adUrl,"cb",Math.floor(1e4*Math.random()))}catch(i){}var s={tag:e,xml:t.xml};this.vastClient=new opti.VASTClient(s,this.onVASTLoaded_.bind(this),h["default"].DEBUG)}},{key:"startAd",value:function(){this.isAdStartInit=!0,this.ad&&(this.startTime=r["default"].now(),this.timeoutID=setTimeout(this.checkResponseTime_.bind(this),100),this.ad.startAd())}},{key:"stopAd",value:function(){this.isStopAdCalled=!0,this.ad&&this.ad.stopAd(),this.onAdStop()}},{key:"skipAd",value:function(){this.ad&&this.ad.skipAd()}},{key:"resizeAd",value:function(t){this.ad&&this.ad.resizeAd(t)}},{key:"pauseAd",value:function(){this.ad&&this.ad.pauseAd()}},{key:"resumeAd",value:function(){this.ad&&this.ad.resumeAd()}},{key:"destroy",value:function(){this.ad&&this.ad.destroy(),this.slot.removeChild(this.adSlot),this.loadTime=0,this.startTime=0,this.responseTime=0,this.maxTime=25e3,clearTimeout(this.timeoutID),this.timeoutID=0,this.vastClient=null,this.vastAd=null,this.sources=[],this.source=null,this.srcIdx=0,this.isPlayerInit=!1,this.isQuartilesDone=!1,this.isSkipped=!1,this.isStopped=!1,this.isStopAdCalled=!1,this.isActive=!1,this.isAdLoaded=!1,this.isAdLoading=!1,this.isAdStartInit=!1,this.isAdImpressed=!1,this.ad=null,this.slot=null,this.videoslot=null,this.adVo=null,this.ref=null,this.moat=null,this.ids=null,this.testVid=null,this.isActive=!1,this.adData=null}},{key:"onAdLoaded",value:function(){this.isAdLoaded=!0,this.isAdLoading=!1,clearTimeout(this.timeoutID),this.loadTime=this.responseTime,this.ref.onAdLoaded(this.idx)}},{key:"onAdStart",value:function(){var t=this.source&&this.source.src;d.tracker.initMoat(this.slot,this.ids,this.adVo.duration,t),this.ref.onAdStart(this.idx)}},{key:"onAdImpression",value:function(){this.isAdImpressed||(this.isAdImpressed=!0,clearTimeout(this.timeoutID),this.adData.responseTime+=Math.floor(this.responseTime),this.responseTime=0,this.adVo.impressedAdId=this.adData.adID,d.tracker.trackMoat("AdVideoStart",this.adVo.volume),this.ref.onAdImpression(this.idx))}},{key:"onAdPlay",value:function(){d.tracker.trackMoat("AdPlaying",this.adVo.volume),this.ref.onAdPlay()}},{key:"onAdQuartile",value:function(){d.tracker.trackMoat("AdVideoFirstQuartile",this.adVo.volume),this.ref.onAdQuartile()}},{key:"onAdMid",value:function(){d.tracker.trackMoat("AdVideoMidpoint",this.adVo.volume),this.ref.onAdMid()}},{key:"onAdThird",value:function(){this.isQuartilesDone=!0,d.tracker.trackMoat("AdVideoThirdQuartile",this.adVo.volume),this.ref.onAdThird()}},{key:"onAdPause",value:function(){d.tracker.trackMoat("AdPaused",this.adVo.volume),this.ref.onAdPause()}},{key:"onAdStop",value:function(){this.isStopped=!0,d.tracker.trackMoat("AdStopped",this.adVo.volume),this.moat=null,this.ref.onAdStop()}},{key:"onAdSkipped",value:function(){this.isSkipped=!0,this.ref.onAdSkipped()}},{key:"onAdComplete",value:function(){this.isStopped||this.isSkipped||!this.isQuartilesDone?this.onAdError({errorCode:900,message:"Undefined Error"}):(d.tracker.trackMoat("AdVideoComplete",this.adVo.volume),this.ref.onAdComplete(this.idx))}},{key:"onAdError",value:function(t){clearTimeout(this.timeoutID),this.adData&&(this.adData.responseTime+=Math.floor(this.responseTime)),this.ref.onAdError(t,this.idx)}},{key:"onAdClickThrough",value:function(){this.ref.onAdClickThrough()}},{key:"onAdRemainingTimeChange",value:function(){this.ref.onAdRemainingTimeChange()}},{key:"onAdDurationChange",value:function(){this.ref.onAdDurationChange()}},{key:"onAdVolumeChange",value:function(){d.tracker.trackMoat("AdVolumeChange",this.adVo.volume),this.ref.onAdVolumeChange()}},{key:"onAdSizeChange",value:function(){this.ref.onAdSizeChange()}},{key:"onAdSkippableStateChange",value:function(){this.ref.onAdSkippableStateChange()}},{key:"onVASTLoaded_",value:function(t,e){if(t&&1e3===t.errorCode&&r["default"].isFlashSupported)this.ad=new y["default"](this),this.ad.requestAd();else if(!t&&e){var i=e.ads,s=e.pod;if(this.vastAd=i.length?i[0]:s.length?s[0]:null,this.sources=this.buildSources_(this.vastAd.media),this.sources.length>0)this.source=this.sources[this.srcIdx],"flash"===this.source.adtype?this.ad=new y["default"](this):"js"===this.source.adtype?this.ad=new v["default"](this):"html5"===this.source.adtype&&(this.ad=new c["default"](this)),this.ad.requestAd();else{var a={errorCode:403,message:"Could not find supported MediaFile"};this.vastAd.tracker.trackError(a),this.onAdError(a)}}else this.onAdError(t)}},{key:"buildSources_",value:function(t){function e(t){var e={type:t.type,src:t.url,width:t.width,height:t.height,bitrate:t.bitrate,maxBitrate:t.maxBitrate,adtype:t.adtype};"js"===t.adtype?i.unshift(e):i.push(e)}for(var i=[],s=0,a=t.length;a>s;s++){var n=t[s];!r["default"].isFlashSupported||"video/x-flv"!==n.type&&"application/x-shockwave-flash"!==n.type?"application/javascript"===n.type?(n.adtype="js",e(n)):"video/mp4"!==n.type&&"video/webm"!==n.type&&"video/ogg"!==n.type||(n.adtype="html5",e(n)):(n.adtype="flash",e(n))}return i}},{key:"checkResponseTime_",value:function(){this.responseTime=Math.floor(r["default"].now()-this.startTime)+this.loadTime,this.responseTime>this.maxTime?this.onAdError({errorCode:1001,message:"Ad Timedout"}):this.timeoutID=setTimeout(this.checkResponseTime_.bind(this),100)}}]),t}()},{"../config":7,"../log/logger":10,"../utils/tracker":16,"../utils/utility":17,"./flash-ad":4,"./html5-ad":5,"./vpaid-ad":6}],3:[function(t,e,i){"use strict";function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),n=function(){function t(e){s(this,t),this.player=e,this.idx=this.player.idx,this.slot=this.player.adSlot,this.videoslot=this.player.videoslot,this.adVo=this.player.adVo,this.vastAd=this.player.vastAd,this.source=this.player.source,this.vastTracker=this.vastAd?this.vastAd.tracker:null,this.isAdInit=!1}return a(t,[{key:"setVolume",value:function(t){}},{key:"getRemainingTime",value:function(){return this.adVo.remainingTime}},{key:"getDuration",value:function(){return this.adVo.duration}},{key:"startAd",value:function(){}},{key:"stopAd",value:function(){}},{key:"skipAd",value:function(){}},{key:"resizeAd",value:function(t){}},{key:"pauseAd",value:function(){}},{key:"resumeAd",value:function(){}},{key:"destroy",value:function(){this.isAdInit=!1,this.removeListeners_(),this.removeChildren_(),this.vastTracker=null,this.player=null,this.slot=null,this.videoslot=null,this.adVo=null,this.vastAd=null,this.source=null}},{key:"onAdLoaded",value:function(){this.player.onAdLoaded()}},{key:"onAdStart",value:function(){this.player.onAdStart()}},{key:"onAdImpression",value:function(){this.player.onAdImpression()}},{key:"onAdPlay",value:function(){this.player.onAdPlay()}},{key:"onAdQuartile",value:function(){this.player.onAdQuartile()}},{key:"onAdMid",value:function(){this.player.onAdMid()}},{key:"onAdThird",value:function(){this.player.onAdThird()}},{key:"onAdPause",value:function(){this.player.onAdPause()}},{key:"onAdStop",value:function(){this.player.onAdStop()}},{key:"onAdSkipped",value:function(){this.player.onAdSkipped()}},{key:"onAdComplete",value:function(){this.player.onAdComplete()}},{key:"onAdError",value:function(t){this.player.onAdError(t)}},{key:"onAdClickThrough",value:function(){this.player.onAdClickThrough()}},{key:"onAdRemainingTimeChange",value:function(){this.player.onAdRemainingTimeChange()}},{key:"onAdDurationChange",value:function(){this.player.onAdDurationChange()}},{key:"onAdVolumeChange",value:function(){this.player.onAdVolumeChange()}},{key:"onAdSizeChange",value:function(){this.player.onAdSizeChange()}},{key:"onAdSkippableStateChange",value:function(){this.player.onAdSkippableStateChange()}},{key:"initAd_",value:function(){this.isAdInit=!0}},{key:"removeListeners_",value:function(){}},{key:"removeChildren_",value:function(){try{for(;this.slot.firstChild;)this.slot.removeChild(this.slot.firstChild)}catch(t){}}}]),t}();i["default"]=n},{"../log/logger":10}],4:[function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),d=function y(t,e,i){null===t&&(t=Function.prototype);var s=Object.getOwnPropertyDescriptor(t,e);if(void 0===s){var a=Object.getPrototypeOf(t);return null===a?void 0:y(a,e,i)}if("value"in s)return s.value;var n=s.get;if(void 0!==n)return n.call(i)},l=t("./base-ad"),h=s(l),u=t("../utils/utility"),c=s(u),p=t("../config"),v=s(p),f=function(t){function e(t){a(this,e);var i=n(this,Object.getPrototypeOf(e).call(this,t)),s=i.adVo.width>=398&&i.adVo.height>=298;return i.flashHolder=null,i.optiswfobj=null,i.adData=i.player.adData,i.doResizeAd=!!window.chrome&&!!window.chrome.webstore&&!s,i}return o(e,t),r(e,[{key:"setVolume",value:function(t){this.fireFlashCall_("setVolume",t)}},{key:"getRemainingTime",value:function(){return this.fireFlashCall_("getRemainingTime")}},{key:"getDuration",value:function(){return this.fireFlashCall_("getDuration")}},{key:"requestAd",value:function(){this.isAdInit&&this.destroy(),this.initAd_()}},{key:"startAd",value:function(){this.fireFlashCall_("startAd")}},{key:"stopAd",value:function(){}},{key:"skipAd",value:function(){this.fireFlashCall_("skipAd")}},{key:"resizeAd",value:function(t){this.adVo=t,this.fireFlashCall_("resizeAd",this.adVo.width,this.adVo.height,"normal")}},{key:"pauseAd",value:function(){this.fireFlashCall_("pauseAd")}},{key:"resumeAd",value:function(){this.fireFlashCall_("resumeAd")}},{key:"destroy",value:function(){d(Object.getPrototypeOf(e.prototype),"destroy",this).call(this),this.flashHolder=null,this.optiswfobj=null,this.adData=null}},{key:"onAdError",value:function(t){this.flashHolder.style.visibility="hidden",d(Object.getPrototypeOf(e.prototype),"onAdError",this).call(this,t)}},{key:"onAdStop",value:function(){this.optiswfobj=null,this.flashHolder=null,d(Object.getPrototypeOf(e.prototype),"onAdStop",this).call(this)}},{key:"initAd_",value:function(){d(Object.getPrototypeOf(e.prototype),"initAd_",this).call(this);try{var t=this.slot.ownerDocument.defaultView,i="FlashAd"+this.idx,s="optiswfobj"+this.idx,a="",n="",o="";t.opti=t.opti||{},t.opti[i]=this,a+="&debug="+v["default"].DEBUG,a+="&volume="+this.adVo.volume,a+="&width="+this.adVo.width,a+="&height="+this.adVo.height,a+="&ref=opti."+i,a+="&idx="+this.idx,this.flashHolder=document.createElement("div"),this.flashHolder.id="opti-flash-ad"+this.idx,this.flashHolder.style.position="absolute",this.flashHolder.style.top="0",this.flashHolder.style.left="0",this.doResizeAd?(this.flashHolder.style.width="398px",this.flashHolder.style.height="298px",this.flashHolder.style.visibility="hidden",o+="name='"+s+"' id='"+s+"' width = '100%' height = '100%'"):o+="name='"+s+"' id='"+s+"' width='"+this.adVo.width+"' height='"+this.adVo.height+"'",n+="<param name='allowscriptaccess' value='always'/>",n+="<param name='allownetworking' value='all'/>",n+="<param name='wmode' value='direct'/>",n+="<param name='bgcolor' value='000000'/>",n+="<param name='flashvars' value='"+a+"'/>",c["default"].isOldIE()?(o+="classid='clsid:D27CDB6E-AE6D-11cf-96B8-444553540000'",n+="<param name='movie' value='"+v["default"].FLASH_PLAYER_PATH+"'/>"):(o+="data='"+v["default"].FLASH_PLAYER_PATH+"' ",o+="type=application/x-shockwave-flash"),this.flashHolder.innerHTML="<object style='display: block' "+o+">"+n+"</object>",this.slot.appendChild(this.flashHolder),this.optiswfobj=t[s]}catch(r){}}},{key:"onFlashAdInit_",value:function(){this.doResizeAd&&(this.flashHolder.style.width=this.adVo.width+"px",this.flashHolder.style.height=this.adVo.height+"px",this.flashHolder.style.visibility="visible"),this.fireFlashCall_("requestAd",this.adData.adUrl,this.adData.xml)}},{key:"fireFlashCall_",value:function(t){if(this.optiswfobj)try{for(var e=arguments.length,i=Array(e>1?e-1:0),s=1;e>s;s++)i[s-1]=arguments[s];return this.optiswfobj[t].apply(this.optiswfobj,i)}catch(a){}}}]),e}(h["default"]);i["default"]=f},{"../config":7,"../log/logger":10,"../utils/utility":17,"./base-ad":3}],5:[function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),d=function v(t,e,i){null===t&&(t=Function.prototype);var s=Object.getOwnPropertyDescriptor(t,e);if(void 0===s){var a=Object.getPrototypeOf(t);return null===a?void 0:v(a,e,i)}if("value"in s)return s.value;var n=s.get;if(void 0!==n)return n.call(i)},l=t("./base-ad"),h=s(l),u=t("../utils/utility"),c=s(u),p=function(t){function e(t){a(this,e);var i=n(this,Object.getPrototypeOf(e).call(this,t));return i.blocker=null,i.eventHandlers=null,i.state={adloading:!1,adstarted:!1,adplaying:!1,adpaused:!1,adskipped:!1,adended:!1,adstopped:!1},i}return o(e,t),r(e,[{key:"setVolume",value:function(t){this.videoslot.volume=t}},{key:"getRemainingTime",value:function(){return this.adVo.remainingTime}},{key:"getDuration",value:function(){return this.adVo.duration}},{key:"requestAd",value:function(){this.isAdInit&&this.reset(),this.initAd_()}},{key:"startAd",value:function(){this.videoslot.src=this.source.src,this.videoslot.muted&&c["default"].isMobile()&&(this.adVo.volume=0,this.videoslot.volume=0),this.videoslot.style?this.videoslot.style.display="block":this.videoslot.display="block",this.videoslot.play()}},{key:"stopAd",value:function(){this.state.adstopped=!0,this.videoslot.pause(),this.videoslot.currentTime=0}},{key:"skipAd",value:function(){this.state.adskipped=!0,this.onPlayerEnded_()}},{key:"resizeAd",value:function(t){this.adVo=t,this.videoslot.style?(this.videoslot.style.width=this.adVo.width+"px",this.videoslot.style.height=this.adVo.height+"px"):(this.videoslot.width=this.adVo.width+"px",this.videoslot.height=this.adVo.height+"px"),this.onAdSizeChange()}},{key:"pauseAd",value:function(){this.videoslot.pause()}},{key:"resumeAd",value:function(){this.videoslot.play()}},{key:"expandAd",value:function(){}},{key:"collapseAd",value:function(){}},{key:"destroy",value:function(){d(Object.getPrototypeOf(e.prototype),"destroy",this).call(this),this.state={adloading:!1,adstarted:!1,adplaying:!1,adpaused:!1,adskipped:!1,adended:!1,adstopped:!1},this.state=null,this.blocker=null}},{key:"initAd_",value:function(){var t=this;d(Object.getPrototypeOf(e.prototype),"initAd_",this).call(this),this.blocker=window.document.createElement("a"),this.blocker.style.position="absolute",this.blocker.style.width=this.adVo.width+"px",this.blocker.style.height=this.adVo.height+"px",this.blocker.background="#000",this.blocker.style.opacity=0,this.blocker.style.cursor="pointer",this.blocker.href="#",this.blocker.target="_blank",this.blocker.style.left=0,this.blocker.style.top=0,c["default"].isOldIE()&&(this.blocker.innerHTML='<img src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEAAAAALAAAAAABAAEAAAI=" width="100%" height="100%">'),this.blocker.onclick=function(){t.blocker.href=t.vastTracker.getResolvedClickthrough(),t.vastTracker.trackClicks(),t.onAdClickThrough()},this.slot.appendChild(this.blocker);var i=document;if(c["default"].isMobile()&&this.videoslot.muted){var s=i.createElement("style"),a=i.head.appendChild(s).sheet;a.insertRule("video::-webkit-media-controls-start-playback-button{opacity:0!important;}",0)}this.videoslot.setAttribute("autoplay",""),this.videoslot.setAttribute("playsinline",""),this.eventHandlers={loadstart:this.onPlayerLoadStart_.bind(this),loadmetadata:this.onPlayerLoadMetadata_.bind(this),canplay:this.onPlayerCanPlay_.bind(this),playing:this.onPlayerPlaying_.bind(this),play:this.onPlayerPlay_.bind(this),pause:this.onPlayerPause_.bind(this),timeupdate:this.onPlayerTimeupdate_.bind(this),volumechange:this.onPlayerVolumeChange_.bind(this),resize:this.onPlayerResize_.bind(this),suspend:this.onPlayerSuspend_.bind(this),waiting:this.onPlayerWaiting_.bind(this),abort:this.onPlayerAbort_.bind(this),ended:this.onPlayerEnded_.bind(this),error:this.onPlayerError_.bind(this),fullscreenchange:this.onPlayerFullScreenChange_.bind(this)},this.videoslot.addEventListener("loadstart",this.eventHandlers.loadstart),this.videoslot.addEventListener("loadedmetadata",this.eventHandlers.loadmetadata),this.videoslot.addEventListener("canplay",this.eventHandlers.canplay),this.videoslot.addEventListener("playing",this.eventHandlers.playing),this.videoslot.addEventListener("play",this.eventHandlers.play),this.videoslot.addEventListener("pause",this.eventHandlers.pause),this.videoslot.addEventListener("timeupdate",this.eventHandlers.timeupdate),this.videoslot.addEventListener("volumechange",this.eventHandlers.volumechange),this.videoslot.addEventListener("resize",this.eventHandlers.resize),this.videoslot.addEventListener("suspend",this.eventHandlers.suspend),this.videoslot.addEventListener("waiting",this.eventHandlers.waiting),this.videoslot.addEventListener("abort",this.eventHandlers.abort),this.videoslot.addEventListener("ended",this.eventHandlers.ended),this.videoslot.addEventListener("error",this.eventHandlers.error),this.videoslot.addEventListener("webkitfullscreenchange",this.eventHandlers.fullscreenchange),document.addEventListener("mozfullscreenchange",this.eventHandlers.fullscreenchange),this.videoslot.addEventListener("fullscreenchange",this.eventHandlers.fullscreenchange),this.vastTracker.subscribe("firstQuartile",this.onAdQuartile.bind(this,!1)),this.vastTracker.subscribe("midpoint",this.onAdMid.bind(this,!1)),this.vastTracker.subscribe("thirdQuartile",this.onAdThird.bind(this,!1)),this.state.adloading=!0,this.onAdLoaded()}},{key:"onPlayerLoadStart_",value:function(){}},{key:"onPlayerLoadMetadata_",value:function(){}},{key:"onPlayerCanPlay_",value:function(){if(this.state.adloading){var t=this.videoslot.duration;this.vastTracker.setAssetURI(this.videoslot.src),this.vastTracker.setDuration(t),t>0&&(this.adVo.duration=t,this.adVo.remainingTime=t,this.onAdDurationChange())}}},{key:"onPlayerPlay_",value:function(){this.state.adloading&&!this.state.adstarted&&(this.state.adstarted=!0,this.state.adplaying=!0,this.state.adpaused=!1)}},{key:"onPlayerPlaying_",value:function(){this.state.adloading&&!this.state.adstarted?(this.state.adstarted=!0,this.state.adplaying=!0,this.state.adpaused=!1):this.state.adstarted&&(this.state.adplaying||(this.state.adplaying=!0,this.state.adpaused=!1,this.vastTracker.resume(),this.onAdPlay()))}},{key:"onPlayerPause_",value:function(){this.state.adplaying&&(this.state.adplaying=!1,this.state.adpaused=!0,this.state.adstopped||(this.vastTracker.pause(),this.onAdPause()))}},{key:"onPlayerTimeupdate_",value:function(){var t=this.videoslot.currentTime,e=this.videoslot.duration-t;this.adVo.currentTime=t,this.adVo.remainingTime=e,this.onAdRemainingTimeChange(),t>.1&&!this.isImpressed&&(this.isImpressed=!0,this.adVo.volume!==this.videoslot.volume&&this.setVolume(this.adVo.volume),this.onAdStart(),this.onAdImpression()),t>=this.adVo.duration-.1&&this.state.adplaying&&(this.state.adplaying=!1,this.state.adended=!0),this.state.adplaying&&!this.state.adstopped&&(this.vastTracker.setProgress(t),!this.state.adskipped&&this.vastAd.skipoffset&&t>=this.vastAd.skipoffset&&this.adVo.skippableState===!1&&(this.adVo.skippableState=!0,this.onAdSkippableStateChange()))}},{key:"onPlayerVolumeChange_",value:function(){this.adVo.volume=this.videoslot.volume,this.onAdVolumeChange()}},{key:"onPlayerClick_",value:function(){}},{key:"onPlayerResize_",value:function(){}},{key:"onPlayerSuspend_",value:function(){}},{key:"onPlayerWaiting_",value:function(){}},{key:"onPlayerAbort_",value:function(){}},{key:"onPlayerEnded_",value:function(){(this.state.adended||this.state.adskipped)&&(this.state.adstarted=!1,this.state.adplaying=!1,this.state.adloading=!1,this.state.adpaused=!1,this.state.adskipped?(this.vastTracker.skip(),this.onAdSkipped()):(this.vastTracker.complete(),this.onAdComplete()))}},{key:"onPlayerError_",value:function(){if(this.state.adloading){var t=this.vastTracker.getError(405);this.vastTracker.trackError(t),this.onAdError(t)}}},{key:"onPlayerFullScreenChange_",value:function(){var t=!!document.fullScreen||!!document.mozFullScreen||!!document.webkitIsFullScreen;t?this.vastTracker.fullscreen():this.vastTracker.exitFullScreen()}},{key:"removeListeners_",value:function(){this.videoslot&&this.eventHandlers&&(this.videoslot.removeEventListener("loadstart",this.eventHandlers.loadstart),this.videoslot.removeEventListener("loadedmetadata",this.eventHandlers.loadmetadata),this.videoslot.removeEventListener("canplay",this.eventHandlers.canplay),this.videoslot.removeEventListener("playing",this.eventHandlers.playing),this.videoslot.removeEventListener("play",this.eventHandlers.play),this.videoslot.removeEventListener("pause",this.eventHandlers.pause),this.videoslot.removeEventListener("timeupdate",this.eventHandlers.timeupdate),this.videoslot.removeEventListener("volumechange",this.eventHandlers.volumechange),this.videoslot.removeEventListener("resize",this.eventHandlers.resize),this.videoslot.removeEventListener("suspend",this.eventHandlers.suspend),this.videoslot.removeEventListener("waiting",this.eventHandlers.waiting),this.videoslot.removeEventListener("abort",this.eventHandlers.abort),this.videoslot.removeEventListener("ended",this.eventHandlers.ended),this.videoslot.removeEventListener("error",this.eventHandlers.error),this.videoslot.removeEventListener("webkitfullscreenchange",this.eventHandlers.fullscreenchange),this.videoslot.removeEventListener("fullscreenchange",this.eventHandlers.fullscreenchange),document.removeEventListener("mozfullscreenchange",this.eventHandlers.fullscreenchange)),this.eventHandlers=null}}]),e}(h["default"]);i["default"]=p},{"../log/logger":10,"../utils/utility":17,"./base-ad":3}],6:[function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),d=function v(t,e,i){null===t&&(t=Function.prototype);var s=Object.getOwnPropertyDescriptor(t,e);if(void 0===s){var a=Object.getPrototypeOf(t);return null===a?void 0:v(a,e,i)}if("value"in s)return s.value;var n=s.get;if(void 0!==n)return n.call(i)},l=t("./base-ad"),h=s(l),u=t("../utils/utility"),c=s(u),p=function(t){function e(t){a(this,e);var i=n(this,Object.getPrototypeOf(e).call(this,t));return i.vpaid=null,i.adContainer=null,i.eventHandlers=null,i.isAdComplete=!1,i.isImpressed=!1,i}return o(e,t),r(e,[{key:"setVolume",value:function(t){if(this.vpaid)try{this.vpaid.setAdVolume(t)}catch(e){}}},{key:"getRemainingTime",value:function(){if(this.vpaid)try{return this.vpaid.getAdRemainingTime()}catch(t){}}},{key:"getDuration",value:function(){if(this.vpaid)try{return this.vpaid.getAdDuration()}catch(t){}}},{key:"requestAd",value:function(){this.isAdInit&&this.destroy(),this.initAd_()}},{key:"startAd",value:function(){try{this.adContainer.style.visibility="visible",this.vpaid.startAd()}catch(t){}}},{key:"stopAd",value:function(){try{this.vpaid.stopAd()}catch(t){}}},{key:"skipAd",value:function(){try{this.vpaid.skipAd()}catch(t){this.onAdSkipped()}}},{key:"resizeAd",value:function(t){this.adVo=t;try{this.vpaid.resizeAd(t.width,t.height,"normal")}catch(e){}}},{key:"pauseAd",value:function(){try{this.vpaid.pauseAd()}catch(t){}}},{key:"resumeAd",value:function(){try{this.vpaid.resumeAd()}catch(t){}}},{key:"destroy",value:function(){d(Object.getPrototypeOf(e.prototype),"destroy",this).call(this),this.vpaid=null,this.adContainer=null,this.eventHandlers=null,this.isAdComplete=!1}},{key:"onAdQuartile",value:function(){this.vastTracker.trackQuartile("firstQuartile"),d(Object.getPrototypeOf(e.prototype),"onAdQuartile",this).call(this)}},{key:"onAdMid",value:function(){this.vastTracker.trackQuartile("midpoint"),d(Object.getPrototypeOf(e.prototype),"onAdMid",this).call(this)}},{key:"onAdThird",value:function(){this.vastTracker.trackQuartile("thirdQuartile"),d(Object.getPrototypeOf(e.prototype),"onAdThird",this).call(this)}},{key:"initAd_",value:function(){var t=this;d(Object.getPrototypeOf(e.prototype),"initAd_",this).call(this);var i=document,s=i.createElement("iframe"),a=i.createElement("div"),n=i.createElement("video"),o={AdParameters:this.vastAd.adParameters},r=c["default"].isMobile()?this.videoslot:n,l={slot:null,videoSlot:null,videoSlotCanAutoPlay:!0},h=this.source.src,u=c["default"].isMobile(),p=c["default"].isIOS(),v=/lkqd/.test(h),f=(/yume/.test(h),!1);if(u&&this.videoslot.muted){var y=i.createElement("style"),A=i.head.appendChild(y).sheet;A.insertRule("video::-webkit-media-controls-start-playback-button{opacity:0!important;}",0)}if(u||(r.style.width="100%",r.style.height="100%"),this.adContainer=i.createElement("div"),this.adContainer.id="adContainer",this.adContainer.style.position="absolute",this.adContainer.style.top="0",this.adContainer.style.left="0",this.adContainer.style.width=this.adVo.width+"px",this.adContainer.style.height=this.adVo.height+"px",p&&v){try{f=/imasdk.googleapis.com/.test(document.referrer)}catch(m){}f||(this.adContainer.style.width="0px",this.adContainer.style.height="0px")}n.style.poition="absolute",c["default"].isMobile()&&(n.setAttribute("autoplay",""),n.setAttribute("muted","")),n.setAttribute("playsinline",""),this.videoslot.setAttribute("playsinline",""),a.id="optiSlot"+this.idx,a.style.position="absolute",a.style.left=0,a.style.top=0,s=s.frameElement||s,s.id="adFrame",s.width="100%",s.height="100%",s.style.position="absolute",s.style.left=0,s.style.top=0,s.style.width="100%",s.style.height="100%",s.style.border=0,s.style.margin=0,s.style.padding=0,s.scrolling="no",s.src="about:blank",v?(this.adContainer.appendChild(s),this.adContainer.appendChild(n),this.slot.appendChild(this.adContainer)):(this.adContainer.appendChild(n),this.adContainer.appendChild(s),this.slot.appendChild(this.adContainer)),s.onload=function(){s.contentWindow.onVPAIDLoad_=function(){var e=s.contentWindow,i=e.document,n=i.getElementsByTagName("body")[0];n.appendChild(a),n.style.padding=0,n.style.margin=0,l.slot=a,l.videoSlot=r,t.vpaid=e.getVPAIDAd(),t.eventHandlers={AdLoaded:t.onAdLoaded_.bind(t),AdVideoComplete:t.onAdVideoComplete_.bind(t),AdStopped:t.onAdStop_.bind(t),AdSkipped:t.onAdSkip_.bind(t),AdStarted:t.onAdStarted_.bind(t),AdImpression:t.onAdImpression_.bind(t),AdVideoStart:t.onAdVideoStart_.bind(t),AdVolumeChange:t.onAdVolumeChange_.bind(t),AdSizeChange:t.onAdSizeChange_.bind(t),AdRemainingTimeChange:t.onAdRemainingTimeChange_.bind(t),AdExpandedChange:t.onAdExpandedChange_.bind(t),AdSkippableStateChange:t.onAdSkippableStateChange_.bind(t),AdDurationChange:t.onAdDurationChange_.bind(t),AdClickThru:t.onAdClickThru_.bind(t),AdVideoFirstQuartile:t.onAdVideoFirstQuartile_.bind(t),AdVideoMidpoint:t.onAdVideoMidPoint_.bind(t),AdVideoThirdQuartile:t.onAdVideoThirdQuartile_.bind(t),AdPaused:t.onAdPaused_.bind(t),
AdPlaying:t.onAdPlaying_.bind(t),AdError:t.onAdError_.bind(t),AdLog:t.onAdLog_.bind(t)},t.vpaid.handshakeVersion("2.0"),t.vpaid.subscribe(t.eventHandlers.AdLoaded,"AdLoaded"),t.vpaid.subscribe(t.eventHandlers.AdStarted,"AdStarted"),t.vpaid.subscribe(t.eventHandlers.AdVideoStart,"AdVideoStart"),t.vpaid.subscribe(t.eventHandlers.AdImpression,"AdImpression"),t.vpaid.subscribe(t.eventHandlers.AdVideoComplete,"AdVideoComplete"),t.vpaid.subscribe(t.eventHandlers.AdSkipped,"AdSkipped"),t.vpaid.subscribe(t.eventHandlers.AdStopped,"AdStopped"),t.vpaid.subscribe(t.eventHandlers.AdVolumeChange,"AdVolumeChange"),t.vpaid.subscribe(t.eventHandlers.AdSizeChange,"AdSizeChange"),t.vpaid.subscribe(t.eventHandlers.AdRemainingTimeChange,"AdRemainingTimeChange"),t.vpaid.subscribe(t.eventHandlers.AdExpandedChange,"AdExpandedChange"),t.vpaid.subscribe(t.eventHandlers.AdSkippableStateChange,"AdSkippableStateChange"),t.vpaid.subscribe(t.eventHandlers.AdDurationChange,"AdDurationChange"),t.vpaid.subscribe(t.eventHandlers.AdClickThru,"AdClickThru"),t.vpaid.subscribe(t.eventHandlers.AdVideoFirstQuartile,"AdVideoFirstQuartile"),t.vpaid.subscribe(t.eventHandlers.AdVideoMidpoint,"AdVideoMidpoint"),t.vpaid.subscribe(t.eventHandlers.AdVideoThirdQuartile,"AdVideoThirdQuartile"),t.vpaid.subscribe(t.eventHandlers.AdPaused,"AdPaused"),t.vpaid.subscribe(t.eventHandlers.AdPlaying,"AdPlaying"),t.vpaid.subscribe(t.eventHandlers.AdError,"AdError"),t.vpaid.subscribe(t.eventHandlers.AdLog,"AdLog"),t.vpaid.initAd(t.adVo.width,t.adVo.height,t.adVo.viewMode,t.adVo.desiredBitrate,o,l)}};var g=s.contentWindow.document;g.open().write("<body onload=\"var js = document.createElement('script');js.src = '"+h+"';js.addEventListener('load', function(){console.log(window.onVPAIDLoad_); onVPAIDLoad_();});document.body.appendChild(js);\">"),g.close()}},{key:"onAdLoaded_",value:function(){var t=0;try{this.adVo.volume!==this.vpaid.getAdVolume()&&this.setVolume(this.adVo.volume),t=this.vpaid.getAdDuration()}catch(e){}this.onAdLoaded(),t>0&&(this.adVo.duration=t,this.adVo.remainingTime=t,this.onAdDurationChange())}},{key:"onAdStarted_",value:function(){this.onAdStart()}},{key:"onAdVideoComplete_",value:function(){this.isAdComplete||(this.isAdComplete=!0,this.vastTracker.complete(),this.onAdComplete())}},{key:"onAdStop_",value:function(){this.player.isStopAdCalled&&(this.isAdComplete?this.onAdStop():this.onAdError({errorCode:900,message:"Undefined Error"}))}},{key:"onAdSkip_",value:function(){this.vastTracker.skip(),this.onAdSkipped()}},{key:"onAdImpression_",value:function(){this.onAdImpressed_()}},{key:"onAdVideoStart_",value:function(){this.onAdImpressed_()}},{key:"onAdImpressed_",value:function(){this.isImpressed||(this.isImpressed=!0,this.vastTracker.trackImpression(this.adVo.currentTime),this.onAdImpression())}},{key:"onAdVolumeChange_",value:function(){try{this.adVo.volume=this.vpaid.getAdVolume()}catch(t){}this.onAdVolumeChange()}},{key:"onAdSizeChange_",value:function(){try{this.adVo.width=this.vpaid.getAdWidth(),this.adVo.height=this.vpaid.getAdHeight()}catch(t){}this.onAdSizeChange()}},{key:"onAdRemainingTimeChange_",value:function(){var t=void 0;try{t=this.vpaid.getAdRemainingTime(),this.adVo.currentTime=this.adVo.duration-t}catch(e){}this.onAdRemainingTimeChange(t)}},{key:"onAdExpandedChange_",value:function(){this.onAdExpandedChange()}},{key:"onAdSkippableStateChange_",value:function(){this.adVo.skippableState=this.vpaid.getAdSkippableState(),this.onAdSkippableStateChange()}},{key:"onAdDurationChange_",value:function(){this.onAdDurationChange(this.vpaid.getAdDuration())}},{key:"onAdClickThru_",value:function(){this.vastTracker.trackClicks(),this.onAdClickThrough()}},{key:"onAdVideoFirstQuartile_",value:function(){this.onAdQuartile()}},{key:"onAdVideoMidPoint_",value:function(){this.onAdMid()}},{key:"onAdVideoThirdQuartile_",value:function(){this.onAdThird()}},{key:"onAdPaused_",value:function(){this.vastTracker.pause(),this.onAdPause()}},{key:"onAdPlaying_",value:function(){this.vastTracker.resume(),this.onAdPlay()}},{key:"onAdError_",value:function(){var t=this.vastTracker.getError(900);this.vastTracker.trackError(t),this.onAdError(t)}},{key:"onAdLog_",value:function(){this.onAdLog()}},{key:"removeListeners_",value:function(){if(this.vpaid&&this.eventHandlers)try{this.vpaid.unsubscribe(this.eventHandlers.AdLoaded,"AdLoaded"),this.vpaid.unsubscribe(this.eventHandlers.AdStarted,"AdStarted"),this.vpaid.unsubscribe(this.eventHandlers.AdVideoStart,"AdVideoStart"),this.vpaid.unsubscribe(this.eventHandlers.AdImpression,"AdImpression"),this.vpaid.unsubscribe(this.eventHandlers.AdVideoComplete,"AdVideoComplete"),this.vpaid.unsubscribe(this.eventHandlers.AdSkipped,"AdSkipped"),this.vpaid.unsubscribe(this.eventHandlers.AdStopped,"AdStopped"),this.vpaid.unsubscribe(this.eventHandlers.AdVolumeChange,"AdVolumeChange"),this.vpaid.unsubscribe(this.eventHandlers.AdSizeChange,"AdSizeChange"),this.vpaid.unsubscribe(this.eventHandlers.AdRemainingTimeChange,"AdRemainingTimeChange"),this.vpaid.unsubscribe(this.eventHandlers.AdExpandedChange,"AdExpandedChange"),this.vpaid.unsubscribe(this.eventHandlers.AdSkippableStateChange,"AdSkippableStateChange"),this.vpaid.unsubscribe(this.eventHandlers.AdDurationChange,"AdDurationChange"),this.vpaid.unsubscribe(this.eventHandlers.AdClickThru,"AdClickThru"),this.vpaid.unsubscribe(this.eventHandlers.AdVideoFirstQuartile,"AdVideoFirstQuartile"),this.vpaid.unsubscribe(this.eventHandlers.AdVideoMidpoint,"AdVideoMidpoint"),this.vpaid.unsubscribe(this.eventHandlers.AdVideoThirdQuartile,"AdVideoThirdQuartile"),this.vpaid.unsubscribe(this.eventHandlers.AdPaused,"AdPaused"),this.vpaid.unsubscribe(this.eventHandlers.AdPlaying,"AdPlaying"),this.vpaid.unsubscribe(this.eventHandlers.AdError,"AdError"),this.vpaid.unsubscribe(this.eventHandlers.AdLog,"AdLog")}catch(t){}}}]),e}(h["default"]);i["default"]=p},{"../log/logger":10,"../utils/utility":17,"./base-ad":3}],7:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i["default"]={VERSION:"4.3.1",IVERSION:"2.4.3.1",APP_PATH:"//cdn.optimatic.com/optivpaid/4.3.1/",DEBUG:!1,SERVICE_LIST_URL:"https://delivery.optimatic.com/4.5/webservice/",SERVICE_LIST_SCRIPT:"getAdList.ashx?EnableJSON=y",PLAYER_LOG_URL:"http://playerlog.optimatic.com/log",FLASH_PLAYER_PATH:"//cdn.optimatic.com/optivpaid/4.3.1/opti-ad-player-1.0.4.swf",isSSL:!1}},{}],8:[function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),o=t("./vpaidevent.js"),r=s(o),d=function(){function t(){a(this,t),this.eventsCallbacks_={},this.subscribedEvents_=[]}return n(t,[{key:"subscribe",value:function(t,e){this.subscribedEvents_.push(t),this.eventsCallbacks_[t]=e}},{key:"unsubscribe",value:function(t){this.eventsCallbacks_[t]=null}},{key:"getSubscribedEvents",value:function(){return this.subscribedEvents_}},{key:"onAdLoaded",value:function(){this.dispatch_(r["default"].AD_LOADED)}},{key:"onAdClickThrough",value:function(){this.dispatch_(r["default"].AD_CLICK_THRU)}},{key:"onAdVolumeChange",value:function(){this.dispatch_(r["default"].AD_VOLUME_CHANGE)}},{key:"onAdStart",value:function(){this.dispatch_(r["default"].AD_STARTED)}},{key:"onAdPause",value:function(){this.dispatch_(r["default"].AD_PAUSED)}},{key:"onAdPlay",value:function(){this.dispatch_(r["default"].AD_PLAYING)}},{key:"onAdStop",value:function(){this.dispatch_(r["default"].AD_STOPPED)}},{key:"onAdComplete",value:function(){this.dispatch_(r["default"].AD_VIDEO_COMPLETE)}},{key:"onAdSizeChange",value:function(){this.dispatch_(r["default"].AD_SIZE_CHANGE)}},{key:"onAdLinearChange",value:function(){this.dispatch_(r["default"].AD_LINEAR_CHANGE)}},{key:"onAdDurationChange",value:function(){this.dispatch_(r["default"].AD_DURATION_CHANGE)}},{key:"onAdRemainingTimeChange",value:function(){this.dispatch_(r["default"].AD_REMAINING_TIME_CHANGE)}},{key:"onAdExpandedChange",value:function(){this.dispatch_(r["default"].AD_EXPANDED_CHANGE)}},{key:"onAdError",value:function(){this.dispatch_(r["default"].AD_ERROR)}},{key:"onNoAd",value:function(){this.dispatch_(r["default"].AD_ERROR)}},{key:"onAdRemoved",value:function(){this.dispatch_(r["default"].AD_STOPPED)}},{key:"onAdSkipped",value:function(){this.dispatch_(r["default"].AD_SKIPPED)}},{key:"onAdSkippableStateChange",value:function(){this.dispatch_(r["default"].AD_SKIPPABLE_STATE_CHANGE)}},{key:"onAdQuartile",value:function(){this.dispatch_(r["default"].AD_VIDEO_FIRST_QUARTILE)}},{key:"onAdMid",value:function(){this.dispatch_(r["default"].AD_VIDEO_MID_POINT)}},{key:"onAdThird",value:function(){this.dispatch_(r["default"].AD_VIDEO_THIRD_QUARTILE)}},{key:"onAdImpression",value:function(){this.dispatch_(r["default"].AD_IMPRESSION),this.dispatch_(r["default"].AD_VIDEO_START)}},{key:"onAdLog",value:function(){this.dispatch_(r["default"].AD_LOG)}},{key:"dispatch_",value:function(t){t in this.eventsCallbacks_&&this.eventsCallbacks_[t]()}}]),t}();i["default"]=d},{"../log/logger.js":10,"./vpaidevent.js":9}],9:[function(t,e,i){"use strict";function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var a=function n(){s(this,n)};a.AD_LOADED="AdLoaded",a.AD_STARTED="AdStarted",a.AD_STOPPED="AdStopped",a.AD_SKIPPED="AdSkipped",a.AD_SKIPPABLE_STATE_CHANGE="AdSkippableStateChange",a.AD_SIZE_CHANGE="AdSizeChange",a.AD_LINEAR_CHANGE="AdLinearChange",a.AD_DURATION_CHANGE="AdDurationChange",a.AD_EXPANDED_CHANGE="AdExpandedChange",a.AD_REMAINING_TIME_CHANGE="AdRemainingTimeChange",a.AD_VOLUME_CHANGE="AdVolumeChange",a.AD_IMPRESSION="AdImpression",a.AD_VIDEO_START="AdVideoStart",a.AD_VIDEO_FIRST_QUARTILE="AdVideoFirstQuartile",a.AD_VIDEO_MID_POINT="AdVideoMidpoint",a.AD_VIDEO_THIRD_QUARTILE="AdVideoThirdQuartile",a.AD_VIDEO_COMPLETE="AdVideoComplete",a.AD_CLICK_THRU="AdClickThru",a.AD_INTERACTION="AdInteraction",a.AD_USER_ACCEPT_INVITATION="AdUserAcceptInvitation",a.AD_USER_MINIMIZE="AdUserMinimize",a.AD_USER_CLOSE="AdUserClose",a.AD_PAUSED="AdPaused",a.AD_PLAYING="AdPlaying",a.AD_LOG="AdLog",a.AD_ERROR="AdError",i["default"]=a},{}],10:[function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(i,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},n=t("../config"),o=s(n);i["default"]={warn:function(t){this.log(t,"warn")},error:function(t){this.log(t,"error")},log:function(t,e){o["default"].DEBUG&&(t=t&&"object"===("undefined"==typeof t?"undefined":a(t))?t:"[OPTIVPAID] :: "+t,console[e]?console[e](t):console.log&&console.log(t))}}},{"../config":7}],11:[function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}();t("ima.js-babel6-polyfill");var o=t("./utils/utility"),r=s(o),d=t("./ad/ad-player"),l=t("./service/ad-service"),h=t("./utils/tracker"),u=t("./config"),c=s(u),p=function(){function t(e,i,s,n){a(this,t),this.slot=e,this.videoslot=i,this.adVo=s,this.eventDispatcher=n,this.service=new l.AdService,this.data=null,this.ads=null,this.adData=null,this.adIdx=-1,this.totalAdsNum=0,this.player=null,this.isImpressed=!1,this.isVASTClientLoaded_=!1,this.startTime=0,this.totalTime=0,this.isAdLoaded_=!1,this.firedAdLoaded_=!1,this.firedPreAdLoaded_=!1,this.adStartInit_=!1,this.firedAdStarted_=!1,this.players_=[],this.loaded_=[],this.retryAds_=[],this.isNextAdInit_=!1,this.playerDone_=0,this.ldIdx_=0,this.reqIdx_=0,this.startEventTimerID_=0,this.loadEventTimerID_=0,this.isDestroyed_=!1,this.MAX_RETRY=5,this.retryNum=0,this.adVo.retry=0,r["default"].isMobile()||(this.adVo.volume=1),this.isTestAdId="q145a541html52"===this.adVo.id,this.adPlaying=!1,this.playPauseBtn=null,this.skipBtn=null,this.startTime=r["default"].now(),this.service.init(this.adVo,this.onAdsInit_.bind(this))}return n(t,[{key:"setVolume",value:function(t){this.player&&this.player.setVolume(t)}},{key:"getVolume",value:function(){return this.adVo.volume}},{key:"getRemainingTime",value:function(){return this.player?this.player.getRemainingTime():void 0}},{key:"getDuration",value:function(){return this.player?this.player.getDuration():void 0}},{key:"startAd",value:function(){this.adStartInit_||(this.adStartInit_=!0,this.startNextAd_())}},{key:"startNextAd_",value:function(){var t,e=this.loaded_.length;if(e)if(1===e)t=this.players_[this.loaded_.shift()-1],t&&t.startAd();else for(;e--;)t=this.players_[this.loaded_.shift()-1],t&&t.startAd()}},{key:"stopAd",value:function(){this.player?this.player.stopAd():this.onAdStop()}},{key:"skipAd",value:function(){this.skipBtn.style.display="none",this.player&&this.player.skipAd()}},{key:"resizeAd",value:function(t){this.player&&this.player.resizeAd(t)}},{key:"pauseAd",value:function(){this.player&&(this.adPlaying=!1,this.player.pauseAd())}},{key:"resumeAd",value:function(){this.player&&(this.adPlaying=!0,this.player.resumeAd())}},{key:"destroy",value:function(){this.isDestroyed_=!0,this.player&&(this.player.destroy(),this.player=null);try{for(;this.slot.firstChild;)this.slot.removeChild(this.slot.firstChild)}catch(t){}this.slot.display="none",this.skipBtn=null,this.playPauseBtn=null,this.adPlaying=!1,this.service=null,this.data=null,this.ads=null,this.adData=null,this.adIdx=-1,this.totalAdsNum=0,this.player=null,this.isVASTClientLoaded_=!1,this.isServiceManagerInit_=!1,this.isAdLoaded_=!1,this.firedAdLoaded_=!1,this.firedPreAdLoaded_=!1}},{key:"onAdLoaded",value:function(t){this.loaded_.push(t),this.firedAdLoaded_||this.firedPreAdLoaded_?this.adStartInit_&&this.startNextAd_():(this.firedAdLoaded_=!0,this.onAdPlayerInit_(),this.eventDispatcher.onAdLoaded())}},{key:"onAdStart",value:function(t){this.firedAdStarted_=!0,this.eventDispatcher.onAdStart()}},{key:"onAdImpression",value:function(t){this.isImpressed||(this.isImpressed=!0,this.clearEventTimers_(),this.player=this.players_.splice(t-1,1)[0],this.adData=this.player.adData,this.destroyPlayers_(),h.tracker.trackThirdPartyURLs(),h.tracker.track("trackAd",this.adData),h.tracker.trackComScore(),h.tracker.trackIAS(this.adData),h.tracker.trackWhiteOps(this.adData),this.eventDispatcher.onAdImpression())}},{key:"onAdSkipped",value:function(){var t=this;this.eventDispatcher.onAdSkipped(),setTimeout(function(){t.stopAd()},1e3)}},{key:"onAdComplete",value:function(t){var e=this;h.tracker.track("complete",this.adData),this.eventDispatcher.onAdComplete(),setTimeout(function(){e.stopAd()},1e3)}},{key:"onAdStop",value:function(){this.destroy(),this.eventDispatcher.onAdStop()}},{key:"onAdError",value:function(t,e){if(this.isImpressed)this.fireError_(t,!0);else{var i=this.players_[e-1];!t||1001!==t.errorCode&&303!==t.errorCode||h.tracker.track("noAd",i.adData),this.destroyPlayer_(i),this.loadNextAds_()}}},{key:"onAdSizeChange",value:function(){this.eventDispatcher.onAdSizeChange()}},{key:"onAdClickThrough",value:function(){h.tracker.track("click",this.adData),this.eventDispatcher.onAdClickThrough()}},{key:"onAdDurationChange",value:function(){this.eventDispatcher.onAdDurationChange(),this.eventDispatcher.onAdRemainingTimeChange()}},{key:"onAdRemainingTimeChange",value:function(){this.eventDispatcher.onAdRemainingTimeChange()}},{key:"onAdPlay",value:function(){this.isTestAdId&&(this.playPauseBtn.innerHTML="Pause",this.adPlaying=!0),this.eventDispatcher.onAdPlay()}},{key:"onAdPause",value:function(){this.isTestAdId&&(this.playPauseBtn.innerHTML="Play",this.adPlaying=!1),this.eventDispatcher.onAdPause()}},{key:"onAdSkippableStateChange",value:function(){this.isTestAdId&&(this.skipBtn.style.display="block"),this.eventDispatcher.onAdSkippableStateChange()}},{key:"onAdVolumeChange",value:function(){this.eventDispatcher.onAdVolumeChange()}},{key:"onAdQuartile",value:function(){this.eventDispatcher.onAdQuartile()}},{key:"onAdMid",value:function(){this.eventDispatcher.onAdMid()}},{key:"onAdThird",value:function(){this.eventDispatcher.onAdThird()}},{key:"onAdsInit_",value:function(t,e){t?this.fireError_(t,!0):(this.data=e,this.ads=e.Ad.slice(0),this.totalAdsNum=this.ads.length,this.adVo.totalAds=this.totalAdsNum,this.totalAdsNum?(this.startPreEmptLoadedEventTimer_(),this.loadNextAds_(),this.isNextAdInit_=!0):this.setNoAds())}},{key:"loadNextAds_",value:function(){var t=this.getNextAds_(),e=t.length;if(e)for(var i=0;e>i;i++)this.players_.push(new d.AdPlayer(this.slot,this.videoslot,this.adVo,this,t[i],++this.ldIdx_,++this.reqIdx_));else this.totalAdsNum===this.playerDone_&&this.setNoAds()}},{key:"getNextAds_",value:function(){var t=this.isNextAdInit_?1:4;return this.ads.splice(0,t)}},{key:"setNoAds",value:function(){var t=this;this.adPlaying=!1,h.tracker.track("noAds",this.adData),this.clearEventTimers_(),setTimeout(function(){t.destroy(),t.eventDispatcher.onAdError(),t.videoslot&&t.videoslot.play()},1e3)}},{key:"updateAdsOnRetry_",value:function(){1===this.retryNum?this.retryAds_=this.data.Ad.filter(function(t){return 50!==t.group}):2===this.retryNum&&(this.retryAds_=this.retryAds_.filter(function(t){return 20===t.group||40===t.group})),this.ads=this.retryAds_.slice(0),r["default"].sortFunctionRankAscending=!(this.retryNum%2),this.ads.sort(r["default"].sortFunction),this.totalAdsNum=this.ads.length,r["default"].printDemands(this.data.OrderType,this.ads,c["default"].DEBUG)}},{key:"startPreEmptLoadedEventTimer_",value:function(){var t=this;this.loadEventTimerID_=setTimeout(function(){t.firedAdLoaded_||t.firedPreAdLoaded_||(t.firedPreAdLoaded_=!0,t.eventDispatcher.onAdLoaded())},5e3)}},{key:"startPreEmptStartedEventTimer_",value:function(){var t=this;this.startEventTimerID_=setTimeout(function(){t.firedAdStarted_||t.eventDispatcher.onAdStart()},3e3)}},{key:"clearEventTimers_",value:function(){this.loadEventTimerID_&&clearTimeout(this.loadEventTimerID_),this.loadEventTimerID_=0}},{key:"destroyPlayers_",value:function(){if(this.isDestroyed_)this.destroyPlayer_(this.player);else for(var t=0,e=this.players_.length;e>t;t++)this.destroyPlayer_(this.players_[t])}},{key:"destroyPlayer_",value:function(t){t.isActive&&(this.playerDone_++,t.destroy())}},{key:"fireError_",value:function(t,e){if(e&&this.eventDispatcher.onAdError(),!c["default"].DEBUG&&t)throw t.message="OPTIVPAID :: "+t.message,t}},{key:"onAdPlayerInit_",value:function(){var t=this;if(this.isTestAdId&&(this.controls=document.createElement("div"),this.controls.id="opti-ad-controls",this.controls.style.display="inline-block",this.playPauseBtn=document.createElement("div"),this.playPauseBtn.style.position="absolute",this.playPauseBtn.style.top="10px",this.playPauseBtn.style.left="10px",this.playPauseBtn.style.minWidth="45px",this.playPauseBtn.style.fontFamily="Segoe UI, Segoe, Tahoma, Geneva, sans-serif",this.playPauseBtn.style.fontSize="1.2em",this.playPauseBtn.style.textAlign="center",this.playPauseBtn.style.background="rgba(0, 0, 0, 0.7)",this.playPauseBtn.style.color="#ccc",this.playPauseBtn.style.padding="0.2em 0.4em 0.4em 0.4em",this.playPauseBtn.style.border="1px solid #ccc",this.playPauseBtn.style.cursor="pointer",this.playPauseBtn.innerHTML="Pause",this.playPauseBtn.addEventListener("click",this.onPlayPauseClick_.bind(this)),this.controls.appendChild(this.playPauseBtn),this.skipBtn=window.document.createElement("div"),this.skipBtn.innerHTML="Skip",this.skipBtn.style.position="absolute",this.skipBtn.style.top="10px",this.skipBtn.style.right="10px",this.skipBtn.style.minWidth="45px",this.skipBtn.style.textAlign="center",this.skipBtn.style.fontFamily="Segoe UI, Segoe, Tahoma, Geneva, sans-serif",this.skipBtn.style.fontSize="1.2em",this.skipBtn.style.color="#ccc",this.skipBtn.style.background="rgba(0, 0, 0, 0.7)",this.skipBtn.style.padding="0.2em 0.4em 0.4em 0.4em",this.skipBtn.style.border="1px solid #ccc",this.skipBtn.style.cursor="pointer",this.skipBtn.style.display="none",this.skipBtn.onclick=this.skipAd.bind(this),this.controls.appendChild(this.skipBtn),this.slot.appendChild(this.controls)),!r["default"].isMobile()){var e;!function(){var i=t.slot,s=t.videoslot;e=Array.prototype.slice.call(i.getElementsByTagName("video")),e.forEach(function(t){(t===s||t.id===s.id&&t.id&&s.id)&&(t.style.display="none",t.parentNode===i&&t.parentNode.id===i.id||(t.parentNode.style.visibility="hidden"))})}()}}},{key:"onPlayPauseClick_",value:function(t){t.preventDefault(),this.adPlaying?(this.pauseAd(),this.playPauseBtn.innerHTML="Play"):(this.resumeAd(),this.playPauseBtn.innerHTML="Pause")}}]),t}();i["default"]=p},{"./ad/ad-player":2,"./config":7,"./log/logger":10,"./service/ad-service":13,"./utils/tracker":16,"./utils/utility":17,"ima.js-babel6-polyfill":1}],12:[function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),o=t("./config"),r=s(o),d=t("./utils/utility"),l=s(d),h=t("./optiads"),u=s(h),c=t("./events/event-dispatcher"),p=s(c),v=function(){function t(){a(this,t),this.slot=null,this.videoslot=null,this.adVo={id:"",zone:"default",ad:null,companions:"",desiredBitrate:-1,expanded:!1,width:0,height:0,icons:!1,linear:!0,duration:-2,remainingTime:-2,currentTime:0,skippableState:!1,viewMode:"normal",volume:0,userid:"",position:"0",videoURL:"",videoTitle:"",videoDesc:"",videoID:"",videoAssetURL:"",videoWidth:"",videoHeight:"",age:"",age_range:"",gender:"",segment:"",audience_segment:"",impressedAdId:""},this.eventDispatcher=new p["default"],this.optiAds=null}return n(t,[{key:"handshakeVersion",value:function(t){return"2.0"}},{key:"getAdWidth",value:function(){return this.adVo.width}},{key:"getAdHeight",value:function(){return this.adVo.height}},{key:"getAdRemainingTime",value:function(){return this.optiAds&&(this.adVo.remainingTime=this.optiAds.getRemainingTime()||this.adVo.remainingTime),this.adVo.remainingTime}},{key:"getAdDuration",value:function(){return this.optiAds&&(this.adVo.duration=this.optiAds.getDuration()||this.adVo.duration),this.adVo.duration}},{key:"setAdVolume",value:function(t){this.optiAds?this.optiAds.setVolume(t):this.adVo.volume=t}},{key:"getAdVolume",value:function(){return this.adVo.volume}},{key:"getAdCompanions",value:function(){return this.adVo.companions}},{key:"getAdIcons",value:function(){return this.adVo.icons}},{key:"getAdLinear",value:function(){return this.adVo.linear}},{key:"getAdExpanded",value:function(){return this.adVo.expanded}},{key:"getAdSkippableState",value:function(){return this.adVo.skippableState}},{key:"initAd",value:function(t,e,i,s,a,n){var o=a&&a.AdParameters,d=n,h=!1,c=!1;if(this.adVo.width=t,!this.adVo.width)return this.fireError_(new ReferenceError("Missing Ad Width!"),!0);if(this.adVo.height=e,!this.adVo.height)return this.fireError_(new ReferenceError("Missing Ad Height!"),!0);if(!d)return this.fireError_(new ReferenceError("Missing environment vars!"),!0);if(this.slot=d.slot,!this.slot)return this.fireError_(new ReferenceError("Missing Ad Slot!"),!0);if(this.videoslot=d.videoSlot,!this.videoslot)return this.fireError_(new ReferenceError("Missing Video Slot!"),!0);if(!o)return this.fireError_(new ReferenceError("Missing creative data!"),!0);try{o=JSON.parse(o)}catch(p){return this.fireError_(new ReferenceError("Could not parse AdParameters."),!0)}if(this.adVo.id=o.id,!this.adVo.id)return this.fireError_(new ReferenceError("Missing Optimatic Ad ID!"),!0);r["default"].APP_PATH=o.appurl||r["default"].APP_PATH,r["default"].APP_PATH=r["default"].APP_PATH.length>2e3?r["default"].APP_PATH.substr(0,2e3):r["default"].APP_PATH,r["default"].SERVICE_LIST_URL=o.listurl||r["default"].SERVICE_LIST_URL,r["default"].SERVICE_LIST_URL=r["default"].SERVICE_LIST_URL.length>2e3?r["default"].SERVICE_LIST_URL.substr(0,2e3):r["default"].SERVICE_LIST_URL,o.listurl&&/^https:/i.test(r["default"].SERVICE_LIST_URL)&&(r["default"].isSSL=!0),h=/devtesting/i.test(r["default"].APP_PATH),c=/staging/i.test(r["default"].APP_PATH),r["default"].DEBUG=o.debug&&(h||c)||r["default"].DEBUG,this.adVo.zone=o.zone||this.adVo.zone,this.adVo.viewMode=i||this.viewMode,this.adVo.desiredBitrate=s||this.adVo.desiredBitrate,this.adVo.videoURL=o.videoURL||this.adVo.videoURL,this.adVo.videoTitle=o.videoTitle||this.adVo.videoTitle,this.adVo.videoDesc=o.videoDesc||this.adVo.videoDesc,this.adVo.videoID=o.videoID||this.adVo.videoID,this.adVo.videoAssetURL=o.videoAssetURL||this.adVo.videoAssetURL,this.adVo.videoHeight=o.videoHeight||this.adVo.videoHeight,this.adVo.videoWidth=o.videoWidth||this.adVo.videoWidth,this.adVo.age=o.age||this.adVo.age,this.adVo.age_range=o.age_range||this.adVo.age_range,this.adVo.gender=o.gender||this.adVo.gender,this.adVo.segment=o.segment||this.adVo.segment,this.adVo.audience_segment=o.audience_segment||this.adVo.audience_segment,this.adVo.id=this.adVo.id.length>255?this.adVo.id.substr(0,255):this.adVo.id,this.adVo.zone=this.adVo.zone.length>20?this.adVo.zone.substr(0,20):this.adVo.zone;var v=this.adVo.videoURL;this.adVo.videoURL=""!==v&&"["!==v.charAt(0)?v.substr(0,2e3):"",v=this.adVo.videoTitle,this.adVo.videoTitle=""!==v&&"["!==v.charAt(0)?v.substr(0,255):"",v=this.adVo.videoDesc,this.adVo.videoDesc=""!==v&&"["!==v.charAt(0)?v.substr(0,255):"",v=this.adVo.videoID,this.adVo.videoID=""!==v&&"["!==v.charAt(0)?v.substr(0,255):"",v=this.adVo.videoAssetURL,this.adVo.videoAssetURL=""!==v&&"["!==v.charAt(0)?v.substr(0,2e3):"",this.adVo.videoWidth=/^[0-9]{1,4}$/.test(this.adVo.videoWidth)?this.adVo.videoWidth:"",this.adVo.videoHeight=/^[0-9]{1,4}$/.test(this.adVo.videoHeight)?this.adVo.videoHeight:"",this.adVo.age=/^[0-9]{1,2}$/.test(this.adVo.age)?this.adVo.age:"",this.adVo.age_range=/^([0-9]{1,2})(-)?([0-9]{1,2})$/.test(this.adVo.age_range)?this.adVo.age_range:"",this.adVo.gender=/^[1-2]$/.test(this.adVo.gender)?this.adVo.gender:"",v=this.adVo.segment,this.adVo.segment=""!==v&&"["!==v.charAt(0)?v.substr(0,255):"",v=this.adVo.audience_segment,this.adVo.audience_segment=""!==v&&"["!==v.charAt(0)?v.substr(0,20):"";var f=l["default"].setCookies();this.adVo.userid=f.guid,this.adVo.position=f.position;try{this.optiAds=new u["default"](this.slot,this.videoslot,this.adVo,this.eventDispatcher)}catch(p){this.fireError_(new ReferenceError("Ads Module Initialization Failed."),!0)}}},{key:"startAd",value:function(){this.optiAds&&(this.adPlaying=!0,this.optiAds.startAd())}},{key:"stopAd",value:function(){this.optiAds&&this.optiAds.stopAd()}},{key:"skipAd",value:function(){this.optiAds&&this.adVo.skippableState===!0&&this.optiAds.skipAd()}},{key:"resizeAd",value:function(t,e,i){this.adVo.width===t&&this.adVo.height===e&&this.adVo.viewMode===i||(this.adVo.width=t,this.adVo.height=e,this.adVo.viewMode=i,this.optiAds&&this.optiAds.resizeAd(this.adVo))}},{key:"pauseAd",value:function(){this.optiAds&&(this.adPlaying=!1,this.optiAds.pauseAd())}},{key:"resumeAd",value:function(){this.optiAds&&(this.adPlaying=!0,this.optiAds.resumeAd())}},{key:"expandAd",value:function(){}},{key:"collapseAd",value:function(){}},{key:"subscribe",value:function(t,e,i){this.eventDispatcher.subscribe(e,t.bind(i))}},{key:"unsubscribe",value:function(t){this&&this.eventDispatcher&&this.eventDispatcher.unsubscribe(t)}},{key:"fireError_",value:function(t,e){r["default"].DEBUG||(t.message="OPTIVPAID :: "+t.message,console&&console.error?console.error(t):console&&console.log&&console.log(t)),e&&this.eventDispatcher.onAdError()}}]),t}();window.getVPAIDAd=function(){return new v}},{"./config":7,"./events/event-dispatcher":8,"./log/logger":10,"./optiads":11,"./utils/utility":17}],13:[function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0}),i.AdService=void 0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),o=t("../utils/utility"),r=s(o),d=t("../utils/tracker"),l=t("./cpm-loader"),h=s(l),u=t("../config"),c=s(u);i.AdService=function(){function t(){a(this,t),this.adVo=null,this.cb=null,this.cpmLoadCount=0,this.cpmLoadDone=0,this.cpmLoaders_=[],this.TEST_MODE=!1,this.TEST_URL="//devtesting.optimatic.com/optivpaid/data.js",this.rtbs_=[],this.rtbs2_=[],this.rtbAuctionType="rtb",this.prioritizeRTB=!0,this.winningBid_=null,this.hasRTBAds_=!1,this.placementBidFloor_=0,this.orderType_="",this.isGrouped=!0,this.loadStartTime=null,this.badDomainList=["vast.optimatic.com","vast.ssp.optimatic.com","vast-ssp.optimatic.com"]}return n(t,[{key:"init",value:function(t,e){if(this.adVo=t,this.cb=e,this.adVo.isRTB2=!0,this.adVo.id.toLowerCase()==="Pog5115329go227".toLowerCase()&&(r["default"].domainData.hostname="pogo.com",r["default"].domainData.url="http://pogo.com/"),this.TEST_MODE){var i=this.TEST_URL+"?cb="+Math.round(new Date/1e3);r["default"].get(i).success(this.onAdListLoaded_.bind(this)).error(this.onAdListLoadError_.bind(this))}else{var s=c["default"].SERVICE_LIST_URL+c["default"].SERVICE_LIST_SCRIPT,a={};s+="&page_host="+encodeURIComponent(r["default"].domainData.hostname),s+="&optsrc=vpaidjs",s+="&noCache="+Math.round((new Date).getTime()/1e3),a.partnerID=this.adVo.id,a.page_host=r["default"].domainData.hostname,a.page_title=r["default"].getPageTitle(),a.content_page_url=r["default"].domainData.url,a.page_ref=r["default"].domainData.ref,a.sw=this.adVo.width,a.sh=this.adVo.height,a.alfyzone=this.adVo.zone,a.video_url=this.adVo.videoURL,a.video_title=this.adVo.videoTitle,a.video_desc=this.adVo.videoDesc,a.video_id=this.adVo.videoID,a.video_asset_url=this.adVo.videoAssetURL,a.video_height=this.adVo.videoHeight,a.video_width=this.adVo.videoWidth,a.age=this.adVo.age,a.age_range=this.adVo.age_range,a.gender=this.adVo.gender,a.segment=this.adVo.segment,a.audience_segment=this.adVo.audience_segment,a.userid=this.adVo.userid,a.position=this.adVo.position,a.v=c["default"].IVERSION,r["default"].domainData.err,r["default"].domainData.refErr,c["default"].DEBUG&&(a.isDebugMode="True"),a=r["default"].serialize(a),this.loadStartTime=r["default"].now(),r["default"].post(s,a,"",!0).success(this.onAdListLoaded_.bind(this)).error(this.onAdListLoadError_.bind(this))}}},{key:"onLoadTimedOut_",value:function(){this.loadTimeout=0}},{key:"onAdListLoaded_",value:function(t){try{t=JSON.parse(t)}catch(e){return void this.cb(new Error("Parsing Failed!"))}this.processData_(t)}},{key:"onAdListLoadError_",value:function(){this.cb(new Error("AdList Service Failed To Load!"))}},{key:"processData_",value:function(t){if(!t||!t.optimatic)return void this.cb(new Error("Parsing Failed!"));this.data=t.optimatic,this.prioritizeRTB=this.data.rtb2Prioritize?"y"===this.data.rtb2Prioritize.toLowerCase():this.prioritizeRTB,this.placementBidFloor_=Number(this.data.TargetCPM),this.orderType_=this.data.OrderType.toLowerCase(),this.isGrouped&&(this.orderType_="group",this.data.OrderType=this.orderType_),d.tracker.init(this.adVo,this.data);for(var e=this.data.Ad,i=e.length;i--;){
var s=e[i];if(s.rank=parseInt(s.rank,10),s.responseTime=0,s.timeStrAd=0,s.idx=i+1,s.xml="",s.kval="",s.bidFloor=0,s.dspCpm=0,s.maxCpm=0,s.isRTB="y"===s.isRTB.toLowerCase(),s.group=s.group?parseInt(s.group,10):0,this.isBadDomain_(s.adUrl))e.splice(i,1),d.tracker.track("noAd",s);else if("var"===s.cpm.toLowerCase()){this.cpmLoadCount++;var a=new h["default"](e.splice(i,1)[0],this.onCPMLoadComplete_.bind(this),this.data.rtbDataPost,this.adVo,this.TEST_MODE);this.cpmLoaders_.push(a)}else!this.isGrouped||10!==s.group&&30!==s.group||(s.group=40),s.cpm=parseFloat(s.cpm)}this.cpmLoadCount||this.setCallback_()}},{key:"onCPMLoadComplete_",value:function(t){if(this.cpmLoadDone++,"err"===t.cpm?d.tracker.track("noAd",t):"var"===t.cpm?d.tracker.track("noAd",t):(t.cpm=parseFloat(t.cpm),!isNaN(t.cpm)&&t.cpm>=this.placementBidFloor_&&t.cpm>=t.bidFloor?t.isRTB?(this.hasRTBAds_||(this.hasRTBAds_=!0),this.adVo.isRTB2?this.isGrouped?10===t.group?this.rtbs_.push(t):30===t.group?this.rtbs2_.push(t):(t.group=30,this.rtbs2_.push(t)):this.rtbs_.push(t):this.data.Ad.push(t)):this.data.Ad.push(t):d.tracker.track("noAd",t)),this.cpmLoadCount===this.cpmLoadDone){for(var e=0,i=this.cpmLoaders_.length;i>e;e++)this.cpmLoaders_[e]=null;this.cpmLoaders_=null,this.adVo.isRTB2&&this.hasRTBAds_?this.rtbs_.length&&this.setAuction_(this.rtbs_):this.sortBy_(this.orderType_,this.data.Ad),this.rtbs2_.length&&this.setAuction_(this.rtbs2_),this.setCallback_()}}},{key:"setCallback_",value:function(){var t=[],e=this.data.Ad.slice(0);r["default"].sortFunctionRankAscending=!0,e.sort(r["default"].sortFunction);var i=e.slice(0);r["default"].sortFunctionRankAscending=!1,i.sort(r["default"].sortFunction);var s=e.concat(i);t=t.concat(s),t=t.concat(s),t=t.concat(s),this.data.Ad=t.slice(0),r["default"].printDemands(this.orderType_,this.data.Ad,c["default"].DEBUG),this.cb(null,this.data)}},{key:"setAuction_",value:function(t){"mix"===this.rtbAuctionType?this.setMixAuction_(t):this.setRtbOnlyAuction_(t),this.isGrouped?this.data.Ad.push(this.winningBid_):this.setRTBPriority_()}},{key:"setMixAuction_",value:function(t){var e=t.concat(this.data.Ad),i=null;this.sortBy_("cpm",e);for(var s=(e.map(function(t){return"[cpm:"+t.cpm+",adId:"+t.adID+",rtb:"+t.isRTB+"]"}),void 0),a=void 0,n=0,o=e.length;o>n;n++)if(i=e[n],i.isRTB){n>0&&(s=e[n-1]),a=s&&s.cpm===i.cpm?s:e[n+1],this.winningBid_=this.getWinningBid_(i,a);break}}},{key:"setRtbOnlyAuction_",value:function(t){this.sortBy_("cpm",t);t.map(function(t){return"[cpm:"+t.cpm+",adId:"+t.adID+",rtb:"+t.isRTB+"]"});this.winningBid_=this.getWinningBid_(t[0],t[1])}},{key:"getWinningBid_",value:function(t,e){if(e&&e.isRTB&&t.cpm===e.cpm){var i=[t,e];this.sortBy_("rank",i),t=i[0],e=i[1]}var s=t.bidFloor>this.placementBidFloor_?t.bidFloor:this.placementBidFloor_,a=e&&e.cpm>s?e.cpm:s,n=this.setPrecision_(a+t.wbMarkup,4);return n=n>t.cpm?a:n,t.cpm=this.setPrecision_(n,4),this.setAuctionMacro_(t),t.cpm=this.setPrecision_(t.cpm-t.servingFee,4),this.setRTBWinningTracking_(t),t}},{key:"setAuctionMacro_",value:function(t){t.dspCpm=this.setPrecision_(t.cpm/(1-t.marginFee),4),t.maxCpm&&t.dspCpm>t.maxCpm&&(t.dspCpm=t.maxCpm-.01);try{var e=new RegExp("\\"+t.customWinPriceMacro,"ig");t.xml?t.xml=t.xml.replace(e,t.dspCpm):t.adUrl=t.adUrl.replace(e,t.dspCpm)}catch(i){}}},{key:"setRTBWinningTracking_",value:function(t){if(t.optWinUrl){var e=new RegExp("\\${wp}","ig"),i=new RegExp("\\${wpdsp}","ig");t.optWinUrl=t.optWinUrl.replace(e,t.cpm),t.optWinUrl=t.optWinUrl.replace(i,t.dspCpm)}}},{key:"setRTBPriority_",value:function(){this.prioritizeRTB?(this.sortBy_(this.orderType_,this.data.Ad),this.winningBid_&&this.data.Ad.unshift(this.winningBid_)):(this.winningBid_&&this.data.Ad.push(this.winningBid_),this.sortBy_(this.orderType_,this.data.Ad))}},{key:"sortBy_",value:function(t,e){"group"===t?(console.log("sortyBy_ Group?"),e.sort(r["default"].sortFunction)):"rank"===t?e.sort(function(t,e){return t.rank-e.rank}):"cpm"===t&&e.sort(function(t,e){return e.cpm-t.cpm})}},{key:"setPrecision_",value:function(t,e){return e=Math.pow(10,e),Math.round(t*e)/e}},{key:"isBadDomain_",value:function(t){t=t.toLowerCase();for(var e=0,i=this.badDomainList.length;i>e;e++)if(-1!==t.indexOf(this.badDomainList[e].toLowerCase()))return!0;return!1}}]),t}()},{"../config":7,"../log/logger":10,"../utils/tracker":16,"../utils/utility":17,"./cpm-loader":14}],14:[function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),o=t("../utils/utility"),r=s(o),d=t("../utils/timer.js"),l=(s(d),t("../config.js")),h=(s(l),function(){function t(e,i,s,n,o){a(this,t),this.ad=e,this.cb=i,this.adVo=n,this.startTime=r["default"].now(),this.maxTries=2,this.loadTryCount=0,this.isTest=o,this.rtbPost=s,this.errMsg="",this.xhr=null,this.CPMLoadTimer=setTimeout(this.onLoadTimedOut_.bind(this),2e3),this.load_()}return n(t,[{key:"load_",value:function(){if(this.ad.isRTB){var t=this.ad.adUrl+"&enableJSON=y"+(this.adVo.isRTB2?"&isEnhancedRTB=y":"");this.ad.dID&&(this.rtbPost+="&dealId="+this.ad.dID),this.isTest?this.xhr=r["default"].get(this.ad.adUrl).success(this.onLoad_.bind(this)).error(this.onError_.bind(this)):this.xhr=r["default"].post(t,this.rtbPost).success(this.onLoad_.bind(this)).error(this.onError_.bind(this))}else this.xhr=r["default"].get(this.ad.adUrl).success(this.onLoad_.bind(this)).error(this.onError_.bind(this))}},{key:"onLoad_",value:function(t){clearTimeout(this.CPMLoadTimer);(r["default"].now()-this.startTime).toFixed(2);if(this.ad.isRTB)try{t=JSON.parse(t)}catch(e){this.ad.cpm="err"}else try{t=r["default"].parseXML(t)}catch(e){this.ad.cpm="err"}"err"!==this.ad.cpm?this.process_(t):this.setCallback_()}},{key:"process_",value:function(t){this.ad.isRTB?this.processRTB_(t):this.processVAST_(t)}},{key:"processRTB_",value:function(t){try{t=t.optimatic,t&&"success"===t.status&&(this.ad.cpm=t.cpm?Number(t.cpm):"var",this.ad.seatId=t.seat?t.seat:"",this.ad.adDomain=t.addomain?t.addomain:"",this.ad.adUrl=t.nurl?t.nurl:"",this.ad.xml=t.adm?t.adm:"",this.adVo.isRTB2&&(this.ad.servingFee=t.servingFee?Number(t.servingFee):0,this.ad.wbMarkup=t.wb_markup?Number(t.wb_markup):0,this.ad.customWinPriceMacro=t.customWinPriceMacro?t.customWinPriceMacro:"",this.ad.bidFloor=t.bidFloor?Number(t.bidFloor):0,this.ad.marginFee=t.marginFee?Number(t.marginFee):0,this.ad.maxCpm=t.maxCpm?Number(t.maxCpm):0,this.ad.optWinUrl=t.optWinUrl?decodeURIComponent(t.optWinUrl):""))}catch(e){this.ad.cpm="err"}this.setCallback_()}},{key:"processVAST_",value:function(t){try{for(var e=t.getElementsByTagName("Extension"),i=e.length,s=0;i>s;s++){var a=e[s];if("Pricing"===a.getAttribute("type"))for(var n=a.getElementsByTagName("Price"),o=n.length,r=0;o>r;r++){var d=n[r],l=d.getAttribute("model"),h=d.getAttribute("currency");l&&"CPM"===l&&h&&"USD"===h&&(this.ad.cpm=d.childNodes[0].nodeValue,this.ad.xml=t.childNodes[0].outerHTML)}}}catch(u){this.ad.cpm="err"}this.setCallback_()}},{key:"onError_",value:function(t){if(this.loadTryCount++,this.errMsg=t.message,this.loadTryCount>=this.maxTries){(r["default"].now()-this.startTime).toFixed(2);this.ad.cpm="err",this.setCallback_()}else this.load_()}},{key:"onLoadTimedOut_",value:function(){(r["default"].now()-this.startTime).toFixed(2);this.xhr.abort(),this.ad.cpm="err",this.setCallback_()}},{key:"setCallback_",value:function(){this.CPMLoadTimer=null,this.ad.responseTime+=Math.floor(r["default"].now()-this.startTime),this.cb(this.ad)}}]),t}());i["default"]=h},{"../config.js":7,"../log/logger":10,"../utils/timer.js":15,"../utils/utility":17}],15:[function(t,e,i){"use strict";function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var a=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),n=function(){function t(e,i){if(s(this,t),this.timerId_=null,this.duration=0,this.timeoutMax=3e4,this.timeoutCallback=null,this.startTime=null,this.endTime=null,this.now=Utils.now,i){if(!Utils.isFunction(i))throw new TypeError("Timer callback provided is not a function!");this.timeoutCallback=i,e&&!isNaN(e)&&(this.timeoutMax=e)}}return a(t,[{key:"start",value:function(){this.startTime=this.now(),this.timeoutMax&&this.timeoutCallback&&(this.timerId_=setTimeout(this.update_.bind(this),0))}},{key:"stop",value:function(){null!==this.startTime&&(this.endTime=this.now(),this.duration=Math.round(this.endTime-this.startTime),this.timerId_&&(clearTimeout(this.timerId_),this.timerId_=null))}},{key:"update_",value:function(){this.currentTime=this.now(),this.duration=this.currentTime-this.startTime,this.duration>=this.timeoutMax?(this.stop(),Utils.isFunction(this.timeoutCallback)&&this.timeoutCallback()):this.timerId_=setTimeout(this.update_.bind(this),0)}}]),t}();i["default"]=n},{}],16:[function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0}),i.tracker=void 0;var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}(),o=t("../config"),r=s(o),d=t("../utils/utility"),l=s(d),h=function(){function t(){a(this,t),this.data={id:"",status:"",message:"",MoatSR:"",IASSR:"",WOSR:"",WOID:"",retry:"",partnerID:"",Server:"",OrderType:"",rtbDataPost:"",OnLoadURLs:[{vendor:"",url:""}],initThirdPartyURLs:[{vendor:"",url:""}],TrackingEvents:{trackImpression:"",trackAd:"",noAd:"",impression:"",start:"",firstQuartile:"",midpoint:"",thirdQuartile:"",complete:"",mute:"",unmute:"",pause:"",resume:"",close:"",click:"",noAds:""},Ad:[{adID:"",adType:"",adUrl:"",CookieSyncUrl:"",cpm:"",rank:"",fc:"",publisher_id:"",campaign_id:"",isRTB:"",ac:0,campaign_label:"",pop_test_status:"",dealId:"",seatId:"",adDomain:""}]},this.events=null,this.adVo=null,this.isEnabled=!1,this.moatAPI=null}return n(t,[{key:"init",value:function(t,e){this.adVo=t,e&&(this.isEnabled=!0,this.data=e,this.events=this.data.TrackingEvents,this.trackURLs_(this.data.OnLoadURLs))}},{key:"trackThirdPartyURLs",value:function(){this.isEnabled&&this.trackURLs_(this.data.initThirdPartyURLs)}},{key:"track",value:function(t,e,i){var s={};if(this.isEnabled){var a=this.events[t];r["default"].DEBUG&&(s.isDebugMode="True"),"noAd"===t||"trackAd"===t?(s.Advertiser_ID=e.adID,s.alfyzone=this.adVo.zone,s.position=this.adVo.position,s.Rank=e.rank,s.adCpm=e.cpm,s.haveAd="noAd"===t?"N":"Y",s.campaign_id=e.campaign_id,s.ResponseTime=e.responseTime,s.id=this.data.id,e.isRTB&&(s.isRtb="Y"),e.dID&&(s.dealId=e.dID),"trackAd"===t&&(e.seatId&&(s.seatId=e.seatId),e.adDomain&&(s.adDomain=e.adDomain),s.v=r["default"].IVERSION,e.isRTB&&e.optWinUrl&&this.firebeacon_("trackRTB",e.optWinUrl,null,null))):"noAds"===t?s.tracking_id=this.data.id:"start"===t?(s.id=this.data.id,s.Advertiser_ID=e.adID,s.TimeStrAd=e.timeStrAd,s.campaign_id=e.campaign_id):"complete"!==t&&"click"!==t||(s.tracking_id=this.data.id,s.Advertiser_ID=e.adID,s.campaign_id=e.campaign_id,e.isRTB&&(s.isRtb="Y"),e.dID&&(s.dealId=e.dID),e.seatId&&(s.seatId=e.seatId),e.adDomain&&(s.adDomain=e.adDomain)),this.firebeacon_(t,a,l["default"].serialize(s),i)}else i&&i()}},{key:"trackComScore",value:function(){var t=document.createElement("script"),e=["c1=1&c2=18977888&c3=",this.adVo.zone,"&c4=&c5=09&c6=&c10="].join("");t.src=(r["default"].isSSL?"https://sb":"http://b")+".scorecardresearch.com/beacon.js?"+e,document.getElementsByTagName("head")[0].appendChild(t)}},{key:"trackIAS",value:function(t){var e=Math.round(1e3*Math.random()),i=!1;if(this.data.IASSR=parseInt(this.data.IASSR),this.data.IASSR&&(i=e<=10*this.data.IASSR),i){var s=document.createElement("script"),a=["anId=6068&advId=",t.adID,"&campId=",t.adID,"&pubId=",t.publisher_id,"&chanId=",this.adVo.zone,"&placementId=",this.adVo.id].join("");s.src="https://pixel.adsafeprotected.com/jload?"+a,document.getElementsByTagName("head")[0].appendChild(s)}}},{key:"initMoat",value:function(t,e,i,s){var a=Math.round(1e3*Math.random()),n=!1;this.moatAPI=null,this.data.MoatSR=parseInt(this.data.MoatSR),this.data.MoatSR&&(n=a<=10*this.data.MoatSR),n&&(this.partnerCode="optimaticjsvideo257729209919",this.moatAPI=function(t,e,i,s,a){var n=document.createElement("script"),o=[];e={adData:{ids:e,duration:i,url:a},dispatchEvent:function(t){this.sendEvent?(o&&(o.push(t),t=o,o=!1),this.sendEvent(t)):o.push(t)}},i="_moatApi"+Math.floor(1e8*Math.random());var r,d;try{r=t.ownerDocument,d=r.defaultView||r.parentWindow}catch(l){r=document,d=window}return d[i]=e,n.type="text/javascript",t&&t.insertBefore(n,t.childNodes[0]||null),n.src="https://z.moatads.com/"+s+"/moatvideo.js#"+i,e}(t,e,i,this.partnerCode,s))}},{key:"trackMoat",value:function(t,e){this.moatAPI&&this.moatAPI.dispatchEvent({type:t,adVolume:e})}},{key:"trackDoubleVerify",value:function(t){l["default"].loadScript("https://cdn.doubleverify.com/dvtp_src.js?ctx=3891363&sr=5&cmp=OptimaticTest&sid=005&plc=DV-OPTM20170320001&advid=3819603&adsrv=0&region=30&dvtagver=6.1.src&DVP_PID="+t+"&DVP_ADVID=&DVP_DOM="+encodeURIComponent(l["default"].domainData.hostname)+"&turl="+encodeURIComponent(l["default"].domainData.hostname))}},{key:"trackWhiteOps",value:function(t){var e=Math.round(1e3*Math.random()),i=!1,s=void 0;this.data.WOSR=parseInt(this.data.WOSR),this.data.WOSR&&(i=e<=10*this.data.WOSR);try{s=this.isWOIDNew_(this.data.WOID)}catch(a){}if(i&&s){var n=document.createElement("script");n.setAttribute("async","");var o=["di=",encodeURIComponent(l["default"].domainData.hostname),"&ai=",t.adID,"&pi=",this.adVo.id,"&si=",t.publisher_id,"&pv=",this.data.WOID,"&dt=6316951502370492624000"].join("");n.src="https://s.admthop.com/2/631695/analytics.js?"+o,document.getElementsByTagName("head")[0].appendChild(n)}}},{key:"isWOIDNew_",value:function(t){var e=void 0;if(!t)return!0;t=t.toString();try{e=l["default"].getCookie("opti-woid")}catch(i){}if(e){e=e.split(",");for(var s=0,a=e.length;a>s;s++)if(e[s]===t)return!1;e.length>=20&&e.shift();try{l["default"].setCookie("opti-woid",e.join()+","+t,null,22)}catch(i){}return!0}try{l["default"].setCookie("opti-woid",t,null,22)}catch(i){}return!0}},{key:"firebeacon_",value:function(t,e,i,s){var a=i?"post":"get";l["default"][a](e,i).success(function(t){s&&s()}).error(function(){s&&s(new Error("Tracking Failed"))})}},{key:"trackURLs_",value:function(t){for(var e,i=0,s=t.length;s>i;i++)e=t[i].url,e&&""!==e&&((new Image).src=e)}}]),t}();i.tracker=new h},{"../config":7,"../log/logger":10,"../utils/utility":17}],17:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s={};s.setCookies=function(){var t=s.getCookie("opti-position"),e=s.getCookie("opti-userid");if(t?(t=Number(t)+1,s.setCookie("opti-position",t,1)):(t=1,s.setCookie("opti-position",1,360)),e)return{guid:e,position:t};var i=s.getGUID();return s.setCookie("opti-userid",i,360),{guid:i,position:t}},s.setCookie=function(t,e,i,s,a){var n="",o=a?"; domain="+a:"";if(i||s){var r=new Date;i&&r.setTime(r.getTime()+24*i*60*60*1e3),!i&&s&&r.setTime(r.getTime()+60*s*1e3),n="; expires="+r.toUTCString()}document.cookie=t+"="+e+n+o+"; path=/"},s.getCookie=function(t){for(var e=t+"=",i=document.cookie.split(";"),s=0,a=i.length;a>s;s+=1){for(var n=i[s];" "==n.charAt(0);)n=n.substring(1);if(0==n.indexOf(e))return n.substring(e.length,n.length)}return""},s.getGUID=function a(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,a)},s.loadScript=function(t,e){var i=document.createElement("script"),s=!1;i.onload=i.onreadystatechange=function(){return i.readyState&&"complete"!==i.readyState&&"loaded"!==i.readyState||s?!1:(i.onload=i.onreadystatechange=null,s=!0,void e())},i.onerror=function(){e(new Error("Script Loading Failed!"))},i.async=!0,i.src=t,document.getElementsByTagName("head")[0].appendChild(i)},s.merge=function(t,e){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},s.USER_AGENT=navigator.userAgent,s.PROTOCOL=function(){var t="http:",e=window.document.referrer;if(self!==top)if(""!==e)0===e.indexOf("https:")&&(t="https:");else try{t=top.location.protocol}catch(i){}else t=window.location.protocol;return"http:"!==t&&"https:"!==t&&(t="http:"),t}(),s.isIOS=function(){return/iPhone/i.test(s.USER_AGENT)||/iPad/i.test(s.USER_AGENT)||/iPod/i.test(s.USER_AGENT)},s.isAndroid=function(){return/Android/i.test(s.USER_AGENT)},s.isMobile=function(){return s.isIOS()||s.isAndroid()},s.isIE=function(){return/Trident/.test(s.USER_AGENT)},s.isOldIE=function(){return/MSIE/.test(s.USER_AGENT)},s.isChrome=function(){return/Chrome/.test(s.USER_AGENT)},s.isFF=function(){return/Firefox/.test(s.USER_AGENT)},s.isSafari=function(){return/Safari/.test(s.USER_AGENT)},s.isEdge=function(){return/Edge/.test(s.USER_AGENT)},s.browserType=function(){var t="";return t=s.isEdge()?"EG":s.isChrome()?"CH":s.isSafari()?"SF":s.isFF()?"FF":s.isIE()?"IE":s.isOldIE()?"OIE":"OT"}(),s.isTouchEnabled=function(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch)},s.isDesktop=function(){return/Windows/.test(s.USER_AGENT)||/Macintosh/.test(s.USER_AGENT)||/X11/.test(s.USER_AGENT)},s.getPageTitle=function(){var t="0000230",e="0000231",i="0000232",s="0000233",a="",n="";if(null!=window.top)try{n=window.top.document.getElementsByTagName("title")[0]}catch(o){}if(void 0==n||""==n)if(null==window.opener&&null==window.parent.opener)if(window.location==window.parent.location)try{n=document.getElementsByTagName("title")[0]}catch(o){n="",a=e}else try{n=window.parent.document.getElementsByTagName("title")[0]}catch(o){n="",a=e}else if(null!=window.opener)try{n=window.opener.document.getElementsByTagName("title")[0]}catch(o){n="",a=i}else try{n=window.parent.opener.document.getElementsByTagName("title")[0]}catch(o){n="",a=s}return void 0==n?a=t:""!=n&&(n.childNodes.length?a=n.firstChild.data:n.innerHTML&&(a=n.innerHTML)),a},s.getDomainData=function(t,e){var i=function(t){var e="";return t&&(e=t.indexOf("://")>-1?t.split("/")[2]:e=t.split("/")[0],e=e.split(":")[0],e=e.split("?")[0]),e},a=function(){var e=t,i=!1,s=0;try{for(;5>s&&e.parent.document!==e.document;){if(!e.parent.document){i=!0;break}e=e.parent,s++}}catch(a){i=!0}return{topFrame:e,err:i}},n=a(),o=n.topFrame,r="",d="",l="",h="",u={url:"",hostname:"",ref:"",err:"",refErr:""};o=n.err?t:o;try{try{if(o.opener&&o.opener!==t)try{r=o.opener.location.href}catch(c){l+=": 001: "+c,r=o.top.location.href}else r=o.top.location.href}catch(c){l+=": 002: "+c;var p=o.location.ancestorOrigins;r=p[p.length-1]}}catch(c){l+=": 003: "+c}try{if(!r&&o.document.referrer)try{r=o.document.referrer}catch(c){l+=": 004: "+c}}catch(c){l+=": 005: "+c}try{if(!r&&o.location.href)try{r=o.location.href}catch(c){l+=": 006: "+c}}catch(c){l+=": 007: "+c}try{u.hostname=i(r)}catch(c){u.hostname="error : "+c}if(u.hostname=u.hostname?u.hostname:"error : page host undetected",u.hostname=u.hostname.substr(0,255),r?u.url=r.substr(0,255):(l="url: "+r+"; err"+l+"; UA: "+s.USER_AGENT,u.err=l,u.url="error : url undetected"),!n.err){try{d=o.document.referrer}catch(c){h+=": 008: "+c}try{d&&(u.ref=i(d))}catch(c){h+=": 009: "+c}h&&(u.refErr="ref: "+d+"; err"+h+"; UA: "+s.USER_AGENT,u.ref="")}return u}(window,document),s.domainData=s.getDomainData,s.serialize=function(t){var e=[];for(var i in t)t.hasOwnProperty(i)&&e.push(encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return e.join("&")},s.parse=function(t){var e;try{e=JSON.parse(t)}catch(i){e=s.parseXML(t)}return e},s.parseXML=function(t){if(window.DOMParser)return(new window.DOMParser).parseFromString(t,"text/xml");if("undefined"!=typeof window.ActiveXObject&&new window.ActiveXObject("Microsoft.XMLDOM")){var e=new window.ActiveXObject("Microsoft.XMLDOM");return e.async="false",e.loadXML(t),e}},s.xhr=function(t,e,i,s){var a,n,o={success:function(){},error:function(){}};return s="json"===s?"application/json":"application/x-www-form-urlencoded",a=XMLHttpRequest||ActiveXObject,n=new a("MSXML2.XMLHTTP.3.0"),n.open(t,e,!0),n.setRequestHeader("Content-type",s),n.onreadystatechange=function(){4===n.readyState&&(200===n.status?o.success.call(o,n.responseText,n):o.error.call(o,new Error(n.status),n))},n.send(i),{success:function(t){return o.success=t,this},error:function(t){return o.error=t,this},abort:function(){n.onreadystatechange=null,n.abort()}}},s.get=function(t,e){return s.xhr("GET",t,e)},s.post=function(t,e,i){return s.xhr("POST",t,e,i)},s.put=function(t,e,i){return s.xhr("PUT",t,e,i)},s["delete"]=function(t){return s.xhr("DELETE",t)},s.isArray=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},s.forEach=function(t,e,i){if(s.isArray(t)&&e instanceof Function)for(var a=0,n=t.length;n>a;++a)e.call(i,t[a],a,t);return t},s.isFunction=function(t){var e={};return t&&"[object Function]"===e.toString.call(t)},s.now=function(){var t=window.performance||{};return t.now=function(){return t.now||t.webkitNow||t.msNow||t.oNow||t.mozNow||Date.now}(),t.now()},s.isFlashSupported=function(){function t(t){return(t=t.match(/[\d]+/g))?(t.length=3,t.join(".")):""}var e=!1,i="";if(navigator.plugins&&navigator.plugins.length){var s=navigator.plugins["Shockwave Flash"];s&&(e=!0,s.description&&(i=t(s.description))),navigator.plugins["Shockwave Flash 2.0"]&&(e=!0,i="2.0.0.11")}else if(navigator.mimeTypes&&navigator.mimeTypes.length){var a=navigator.mimeTypes["application/x-shockwave-flash"];(e=a&&a.enabledPlugin)&&(i=t(a.enabledPlugin.description))}else try{var n=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7"),e=!0,i=t(n.GetVariable("$version"))}catch(o){try{n=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6"),e=!0,i="6.0.21"}catch(r){try{n=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),e=!0,i=t(n.GetVariable("$version"))}catch(d){}}}return e}(),s.loadScript=function(t,e){var i=document.createElement("script"),s=!1;i.onload=i.onreadystatechange=function(){return i.readyState&&"complete"!==i.readyState&&"loaded"!==i.readyState||s?!1:(i.onload=i.onreadystatechange=null,s=!0,void(e&&e()))},i.onerror=function(){e&&e(new Error("Script Loading Failed!"))},i.async=!0,i.src=t,document.getElementsByTagName("head")[0].appendChild(i)},s.addURLParam=function(t,e,i){return t+=(t.match(/[\?]/g)?"&":"?")+e+"="+i},s.sortFunctionRankAscending=!0,s.increment=0,s.sortFunction=function(t,e){var i=t.cpm,a=e.cpm,n=t.group,o=e.group,r=t.rank,d=e.rank;if(o>n)return-1;if(n>o)return 1;if(s.sortFunctionRankAscending){if(r>d)return 1;if(d>r)return-1}else{if(d>r)return 1;if(r>d)return-1}if(r===d){if(a>i)return 1;if(i>a)return-1}return 0},s.printDemands=function(t,e,i){if(i)for(var s=0,a=e.length;a>s;s++);},i["default"]=s},{"../log/logger":10}]},{},[12]);